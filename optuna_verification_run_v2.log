2025-11-23 22:11:02,151 - INFO - Starting ForteBank AI Hackathon Pipeline...
2025-11-23 22:11:02,152 - INFO - Loading data...
2025-11-23 22:11:02,199 - INFO - Loaded behavior data: (8587, 19)
2025-11-23 22:11:02,199 - INFO - Loaded transactions data: (13113, 7)
2025-11-23 22:11:02,199 - INFO - Cleaning data...
2025-11-23 22:11:02,214 - INFO - Merging data...
2025-11-23 22:11:02,214 - INFO - Transactions dtypes: transdatetime=datetime64[ns], cst_dim_id=int64
2025-11-23 22:11:02,214 - INFO - Behavior dtypes: transdate=datetime64[ns], cst_dim_id=int64
2025-11-23 22:11:02,219 - INFO - Merged data shape: (13107, 28)
2025-11-23 22:11:02,221 - INFO - Generating features...
2025-11-23 22:11:02,221 - INFO - Generating velocity features...
2025-11-23 22:11:02,251 - INFO - Generating interaction features...
2025-11-23 22:11:02,253 - INFO - Generating identity features...
2025-11-23 22:11:02,258 - INFO - Generating graph features...
2025-11-23 22:11:02,264 - INFO - Generating time delta features...
2025-11-23 22:11:02,265 - INFO - Generating GNN embeddings...
2025-11-23 22:11:02,267 - INFO - Building transaction graph for embeddings...
2025-11-23 22:11:02,269 - INFO - Graph has 2291 nodes (clients + receivers).
2025-11-23 22:11:02,274 - INFO - Generating graph embeddings via TruncatedSVD...
2025-11-23 22:11:02,290 - INFO - Embeddings generated. Explained variance: 0.3792
2025-11-23 22:11:02,296 - INFO - Generating anomaly features (Isolation Forest)...
2025-11-23 22:11:02,449 - INFO - 
============================================================
2025-11-23 22:11:02,449 - INFO - DATA SPLIT:
2025-11-23 22:11:02,449 - INFO - Train set: 11141 transactions (2024-11-30 05:45:05 to 2025-07-07 15:19:13)
2025-11-23 22:11:02,449 - INFO - Holdout set: 1966 transactions (2025-07-07 15:24:01 to 2025-08-29 22:12:01)
2025-11-23 22:11:02,449 - INFO - Train fraud rate: 0.0056
2025-11-23 22:11:02,449 - INFO - Holdout fraud rate: 0.0524
2025-11-23 22:11:02,449 - INFO - ============================================================

2025-11-23 22:11:02,459 - INFO - 
============================================================
2025-11-23 22:11:02,459 - INFO - TRAINING MODELS (Optuna: True)
2025-11-23 22:11:02,459 - INFO - ============================================================

2025-11-23 22:11:02,459 - INFO - Training final CatBoost model...
2025-11-23 22:11:02,511 - INFO - Optimizing CatBoost hyperparameters (20 trials)...
[I 2025-11-23 22:11:02,512] A new study created in memory with name: catboost_optimization
  0%|          | 0/20 [00:00<?, ?it/s]                                        0%|          | 0/20 [00:07<?, ?it/s]Best trial: 0. Best value: 0.946746:   0%|          | 0/20 [00:07<?, ?it/s]Best trial: 0. Best value: 0.946746:   5%|▌         | 1/20 [00:07<02:31,  8.00s/it]                                                                                   Best trial: 0. Best value: 0.946746:   5%|▌         | 1/20 [00:14<02:31,  8.00s/it]Best trial: 1. Best value: 0.95656:   5%|▌         | 1/20 [00:14<02:31,  8.00s/it] Best trial: 1. Best value: 0.95656:  10%|█         | 2/20 [00:14<02:05,  6.97s/it]                                                                                  Best trial: 1. Best value: 0.95656:  10%|█         | 2/20 [00:24<02:05,  6.97s/it]Best trial: 1. Best value: 0.95656:  10%|█         | 2/20 [00:24<02:05,  6.97s/it]Best trial: 1. Best value: 0.95656:  15%|█▌        | 3/20 [00:24<02:21,  8.29s/it]                                                                                  Best trial: 1. Best value: 0.95656:  15%|█▌        | 3/20 [00:30<02:21,  8.29s/it]Best trial: 3. Best value: 0.95885:  15%|█▌        | 3/20 [00:30<02:21,  8.29s/it]Best trial: 3. Best value: 0.95885:  20%|██        | 4/20 [00:30<01:58,  7.39s/it]                                                                                  Best trial: 3. Best value: 0.95885:  20%|██        | 4/20 [00:34<01:58,  7.39s/it]Best trial: 3. Best value: 0.95885:  20%|██        | 4/20 [00:34<01:58,  7.39s/it]Best trial: 3. Best value: 0.95885:  25%|██▌       | 5/20 [00:34<01:34,  6.33s/it]                                                                                  Best trial: 3. Best value: 0.95885:  25%|██▌       | 5/20 [00:47<01:34,  6.33s/it]Best trial: 3. Best value: 0.95885:  25%|██▌       | 5/20 [00:47<01:34,  6.33s/it]Best trial: 3. Best value: 0.95885:  30%|███       | 6/20 [00:47<02:02,  8.72s/it]                                                                                  Best trial: 3. Best value: 0.95885:  30%|███       | 6/20 [01:02<02:02,  8.72s/it]Best trial: 3. Best value: 0.95885:  30%|███       | 6/20 [01:02<02:02,  8.72s/it]Best trial: 3. Best value: 0.95885:  35%|███▌      | 7/20 [01:02<02:16, 10.50s/it]                                                                                  Best trial: 3. Best value: 0.95885:  35%|███▌      | 7/20 [01:11<02:16, 10.50s/it]Best trial: 3. Best value: 0.95885:  35%|███▌      | 7/20 [01:11<02:16, 10.50s/it]Best trial: 3. Best value: 0.95885:  40%|████      | 8/20 [01:11<02:01, 10.10s/it]                                                                                  Best trial: 3. Best value: 0.95885:  40%|████      | 8/20 [01:26<02:01, 10.10s/it]Best trial: 3. Best value: 0.95885:  40%|████      | 8/20 [01:26<02:01, 10.10s/it]Best trial: 3. Best value: 0.95885:  45%|████▌     | 9/20 [01:26<02:09, 11.78s/it]                                                                                  Best trial: 3. Best value: 0.95885:  45%|████▌     | 9/20 [01:31<02:09, 11.78s/it]Best trial: 3. Best value: 0.95885:  45%|████▌     | 9/20 [01:31<02:09, 11.78s/it]Best trial: 3. Best value: 0.95885:  50%|█████     | 10/20 [01:31<01:35,  9.56s/it]                                                                                   Best trial: 3. Best value: 0.95885:  50%|█████     | 10/20 [01:37<01:35,  9.56s/it]Best trial: 3. Best value: 0.95885:  50%|█████     | 10/20 [01:37<01:35,  9.56s/it]Best trial: 3. Best value: 0.95885:  55%|█████▌    | 11/20 [01:37<01:16,  8.45s/it]                                                                                   Best trial: 3. Best value: 0.95885:  55%|█████▌    | 11/20 [01:41<01:16,  8.45s/it]Best trial: 11. Best value: 0.960325:  55%|█████▌    | 11/20 [01:41<01:16,  8.45s/it]Best trial: 11. Best value: 0.960325:  60%|██████    | 12/20 [01:41<00:56,  7.12s/it]                                                                                     Best trial: 11. Best value: 0.960325:  60%|██████    | 12/20 [01:44<00:56,  7.12s/it]Best trial: 11. Best value: 0.960325:  60%|██████    | 12/20 [01:44<00:56,  7.12s/it]Best trial: 11. Best value: 0.960325:  65%|██████▌   | 13/20 [01:44<00:40,  5.77s/it]                                                                                     Best trial: 11. Best value: 0.960325:  65%|██████▌   | 13/20 [01:48<00:40,  5.77s/it]Best trial: 11. Best value: 0.960325:  65%|██████▌   | 13/20 [01:48<00:40,  5.77s/it]Best trial: 11. Best value: 0.960325:  70%|███████   | 14/20 [01:48<00:32,  5.33s/it]                                                                                     Best trial: 11. Best value: 0.960325:  70%|███████   | 14/20 [01:56<00:32,  5.33s/it]Best trial: 14. Best value: 0.965999:  70%|███████   | 14/20 [01:56<00:32,  5.33s/it]Best trial: 14. Best value: 0.965999:  75%|███████▌  | 15/20 [01:56<00:30,  6.05s/it]                                                                                     Best trial: 14. Best value: 0.965999:  75%|███████▌  | 15/20 [02:02<00:30,  6.05s/it]Best trial: 14. Best value: 0.965999:  75%|███████▌  | 15/20 [02:02<00:30,  6.05s/it]Best trial: 14. Best value: 0.965999:  80%|████████  | 16/20 [02:02<00:24,  6.09s/it]                                                                                     Best trial: 14. Best value: 0.965999:  80%|████████  | 16/20 [02:09<00:24,  6.09s/it]Best trial: 14. Best value: 0.965999:  80%|████████  | 16/20 [02:09<00:24,  6.09s/it]Best trial: 14. Best value: 0.965999:  85%|████████▌ | 17/20 [02:09<00:19,  6.43s/it]                                                                                     Best trial: 14. Best value: 0.965999:  85%|████████▌ | 17/20 [02:16<00:19,  6.43s/it]Best trial: 14. Best value: 0.965999:  85%|████████▌ | 17/20 [02:16<00:19,  6.43s/it]Best trial: 14. Best value: 0.965999:  90%|█████████ | 18/20 [02:16<00:13,  6.68s/it]                                                                                     Best trial: 14. Best value: 0.965999:  90%|█████████ | 18/20 [02:23<00:13,  6.68s/it]Best trial: 14. Best value: 0.965999:  90%|█████████ | 18/20 [02:23<00:13,  6.68s/it]Best trial: 14. Best value: 0.965999:  95%|█████████▌| 19/20 [02:23<00:06,  6.63s/it]                                                                                     Best trial: 14. Best value: 0.965999:  95%|█████████▌| 19/20 [02:29<00:06,  6.63s/it]Best trial: 14. Best value: 0.965999:  95%|█████████▌| 19/20 [02:29<00:06,  6.63s/it]Best trial: 14. Best value: 0.965999: 100%|██████████| 20/20 [02:29<00:00,  6.38s/it]Best trial: 14. Best value: 0.965999: 100%|██████████| 20/20 [02:29<00:00,  7.46s/it]
2025-11-23 22:13:31,627 - INFO - Best CatBoost params: {'iterations': 971, 'learning_rate': 0.022899596516859518, 'depth': 6, 'l2_leaf_reg': 1.1194566558270633, 'bagging_temperature': 0.9949178432813726, 'random_strength': 6.761953285858686}
2025-11-23 22:13:31,627 - INFO - Best CV AUC: 0.9660
2025-11-23 22:13:37,407 - INFO - Final CatBoost model trained.
2025-11-23 22:13:37,407 - INFO - Training LightGBM model...
2025-11-23 22:13:37,413 - INFO - Optimizing LightGBM hyperparameters (20 trials)...
[I 2025-11-23 22:13:37,417] A new study created in memory with name: lightgbm_optimization
[I 2025-11-23 22:11:10,521] Trial 0 finished with value: 0.9467463469809161 and parameters: {'iterations': 1194, 'learning_rate': 0.030969724491369487, 'depth': 5, 'l2_leaf_reg': 6.356465520635018, 'bagging_temperature': 0.02324297481712101, 'random_strength': 2.625814901883685}. Best is trial 0 with value: 0.9467463469809161.
[I 2025-11-23 22:11:16,770] Trial 1 finished with value: 0.9565601909697106 and parameters: {'iterations': 625, 'learning_rate': 0.04382951816131594, 'depth': 7, 'l2_leaf_reg': 2.685633218347984, 'bagging_temperature': 0.017425295124022466, 'random_strength': 1.5881483083728198}. Best is trial 1 with value: 0.9565601909697106.
[I 2025-11-23 22:11:26,643] Trial 2 finished with value: 0.9408774742546 and parameters: {'iterations': 1015, 'learning_rate': 0.03822296969686796, 'depth': 7, 'l2_leaf_reg': 2.263377896136619, 'bagging_temperature': 0.42009478998460537, 'random_strength': 8.947675599132877}. Best is trial 1 with value: 0.9565601909697106.
[I 2025-11-23 22:11:32,647] Trial 3 finished with value: 0.9588495521681375 and parameters: {'iterations': 965, 'learning_rate': 0.0430209086439283, 'depth': 4, 'l2_leaf_reg': 5.189157361373108, 'bagging_temperature': 0.7542298182802943, 'random_strength': 8.954329857013724}. Best is trial 3 with value: 0.9588495521681375.
[I 2025-11-23 22:11:37,085] Trial 4 finished with value: 0.9475354385595728 and parameters: {'iterations': 748, 'learning_rate': 0.057612995612608374, 'depth': 4, 'l2_leaf_reg': 7.4161904492566695, 'bagging_temperature': 0.5103565901155945, 'random_strength': 6.0511791966061645}. Best is trial 3 with value: 0.9588495521681375.
[I 2025-11-23 22:11:50,444] Trial 5 finished with value: 0.9229989083687347 and parameters: {'iterations': 1177, 'learning_rate': 0.01321836306123381, 'depth': 8, 'l2_leaf_reg': 8.746910587798977, 'bagging_temperature': 0.45953185514231343, 'random_strength': 1.8627575671899432}. Best is trial 3 with value: 0.9588495521681375.
[I 2025-11-23 22:12:04,601] Trial 6 finished with value: 0.9480983783357226 and parameters: {'iterations': 1195, 'learning_rate': 0.01542637593581811, 'depth': 8, 'l2_leaf_reg': 3.8764889309233395, 'bagging_temperature': 0.8860544151072083, 'random_strength': 6.715501908858148}. Best is trial 3 with value: 0.9588495521681375.
[I 2025-11-23 22:12:13,868] Trial 7 finished with value: 0.9581598516433654 and parameters: {'iterations': 1421, 'learning_rate': 0.03783672139629322, 'depth': 4, 'l2_leaf_reg': 4.972289771413986, 'bagging_temperature': 0.9036546452994123, 'random_strength': 2.601645617147285}. Best is trial 3 with value: 0.9588495521681375.
[I 2025-11-23 22:12:29,330] Trial 8 finished with value: 0.9472663580287507 and parameters: {'iterations': 1490, 'learning_rate': 0.011720012342758265, 'depth': 7, 'l2_leaf_reg': 6.288615302101102, 'bagging_temperature': 0.3848522223575769, 'random_strength': 3.291616692478362}. Best is trial 3 with value: 0.9588495521681375.
[I 2025-11-23 22:12:33,915] Trial 9 finished with value: 0.9586178896005682 and parameters: {'iterations': 438, 'learning_rate': 0.041407233013155215, 'depth': 7, 'l2_leaf_reg': 2.9218448766917327, 'bagging_temperature': 0.8715589425831464, 'random_strength': 4.8417031104930235}. Best is trial 3 with value: 0.9588495521681375.
[I 2025-11-23 22:12:39,850] Trial 10 finished with value: 0.954032775242329 and parameters: {'iterations': 869, 'learning_rate': 0.08526480023252567, 'depth': 5, 'l2_leaf_reg': 9.978104367811401, 'bagging_temperature': 0.6750018488197612, 'random_strength': 9.829129399171368}. Best is trial 3 with value: 0.9588495521681375.
[I 2025-11-23 22:12:43,923] Trial 11 finished with value: 0.9603248983993792 and parameters: {'iterations': 400, 'learning_rate': 0.022565483680857912, 'depth': 6, 'l2_leaf_reg': 1.0676105629020476, 'bagging_temperature': 0.7064712607927586, 'random_strength': 4.915467141082954}. Best is trial 11 with value: 0.9603248983993792.
[I 2025-11-23 22:12:46,592] Trial 12 finished with value: 0.9531141346520591 and parameters: {'iterations': 327, 'learning_rate': 0.022483420143387566, 'depth': 5, 'l2_leaf_reg': 1.279940695668624, 'bagging_temperature': 0.7181547505937558, 'random_strength': 7.835667997089238}. Best is trial 11 with value: 0.9603248983993792.
[I 2025-11-23 22:12:50,920] Trial 13 finished with value: 0.9539546644220271 and parameters: {'iterations': 565, 'learning_rate': 0.02205394390918097, 'depth': 6, 'l2_leaf_reg': 4.401553154543732, 'bagging_temperature': 0.6897633210613224, 'random_strength': 4.317714129554452}. Best is trial 11 with value: 0.9603248983993792.
[I 2025-11-23 22:12:58,621] Trial 14 finished with value: 0.9659985532597688 and parameters: {'iterations': 971, 'learning_rate': 0.022899596516859518, 'depth': 6, 'l2_leaf_reg': 1.1194566558270633, 'bagging_temperature': 0.9949178432813726, 'random_strength': 6.761953285858686}. Best is trial 14 with value: 0.9659985532597688.
[I 2025-11-23 22:13:04,823] Trial 15 finished with value: 0.9639914116239001 and parameters: {'iterations': 775, 'learning_rate': 0.02289343984708233, 'depth': 6, 'l2_leaf_reg': 1.1404025295683855, 'bagging_temperature': 0.985966222406004, 'random_strength': 6.518609036450677}. Best is trial 14 with value: 0.9659985532597688.
[I 2025-11-23 22:13:12,043] Trial 16 finished with value: 0.9593756132205753 and parameters: {'iterations': 767, 'learning_rate': 0.016969180848785004, 'depth': 6, 'l2_leaf_reg': 1.829741693859039, 'bagging_temperature': 0.9742733491646954, 'random_strength': 6.475932832850111}. Best is trial 14 with value: 0.9659985532597688.
[I 2025-11-23 22:13:19,296] Trial 17 finished with value: 0.9559681717149133 and parameters: {'iterations': 1051, 'learning_rate': 0.010157328348674787, 'depth': 5, 'l2_leaf_reg': 3.7087871870526254, 'bagging_temperature': 0.9918472517243724, 'random_strength': 7.630180902928818}. Best is trial 14 with value: 0.9659985532597688.
[I 2025-11-23 22:13:25,824] Trial 18 finished with value: 0.9614783712335433 and parameters: {'iterations': 841, 'learning_rate': 0.024385390860661185, 'depth': 6, 'l2_leaf_reg': 3.197280636670477, 'bagging_temperature': 0.1611626769469825, 'random_strength': 5.776824443402264}. Best is trial 14 with value: 0.9659985532597688.
[I 2025-11-23 22:13:31,626] Trial 19 finished with value: 0.9469300698380967 and parameters: {'iterations': 618, 'learning_rate': 0.02923658026356395, 'depth': 6, 'l2_leaf_reg': 1.7967170135822519, 'bagging_temperature': 0.5821751173681553, 'random_strength': 0.09132037112291247}. Best is trial 14 with value: 0.9659985532597688.
0:	total: 6.13ms	remaining: 5.95s
100:	total: 609ms	remaining: 5.25s
200:	total: 1.23s	remaining: 4.71s
300:	total: 1.82s	remaining: 4.05s
400:	total: 2.37s	remaining: 3.37s
500:	total: 2.96s	remaining: 2.77s
600:	total: 3.55s	remaining: 2.19s
700:	total: 4.13s	remaining: 1.59s
800:	total: 4.74s	remaining: 1s
900:	total: 5.33s	remaining: 414ms
970:	total: 5.75s	remaining: 0us
  0%|          | 0/20 [00:00<?, ?it/s]                                        0%|          | 0/20 [00:02<?, ?it/s]Best trial: 0. Best value: 0.961615:   0%|          | 0/20 [00:02<?, ?it/s]Best trial: 0. Best value: 0.961615:   5%|▌         | 1/20 [00:02<00:50,  2.68s/it]                                                                                   Best trial: 0. Best value: 0.961615:   5%|▌         | 1/20 [00:05<00:50,  2.68s/it]Best trial: 1. Best value: 0.965682:   5%|▌         | 1/20 [00:05<00:50,  2.68s/it]Best trial: 1. Best value: 0.965682:  10%|█         | 2/20 [00:05<00:49,  2.76s/it]                                                                                   Best trial: 1. Best value: 0.965682:  10%|█         | 2/20 [00:08<00:49,  2.76s/it]Best trial: 1. Best value: 0.965682:  10%|█         | 2/20 [00:08<00:49,  2.76s/it]Best trial: 1. Best value: 0.965682:  15%|█▌        | 3/20 [00:08<00:45,  2.66s/it]                                                                                   Best trial: 1. Best value: 0.965682:  15%|█▌        | 3/20 [00:10<00:45,  2.66s/it]Best trial: 1. Best value: 0.965682:  15%|█▌        | 3/20 [00:10<00:45,  2.66s/it]Best trial: 1. Best value: 0.965682:  20%|██        | 4/20 [00:10<00:41,  2.61s/it]                                                                                   Best trial: 1. Best value: 0.965682:  20%|██        | 4/20 [00:13<00:41,  2.61s/it]Best trial: 1. Best value: 0.965682:  20%|██        | 4/20 [00:13<00:41,  2.61s/it]Best trial: 1. Best value: 0.965682:  25%|██▌       | 5/20 [00:13<00:40,  2.69s/it]                                                                                   Best trial: 1. Best value: 0.965682:  25%|██▌       | 5/20 [00:16<00:40,  2.69s/it]Best trial: 1. Best value: 0.965682:  25%|██▌       | 5/20 [00:16<00:40,  2.69s/it]Best trial: 1. Best value: 0.965682:  30%|███       | 6/20 [00:16<00:37,  2.71s/it]                                                                                   Best trial: 1. Best value: 0.965682:  30%|███       | 6/20 [00:17<00:37,  2.71s/it]Best trial: 1. Best value: 0.965682:  30%|███       | 6/20 [00:17<00:37,  2.71s/it]Best trial: 1. Best value: 0.965682:  35%|███▌      | 7/20 [00:17<00:30,  2.36s/it]                                                                                   Best trial: 1. Best value: 0.965682:  35%|███▌      | 7/20 [00:18<00:30,  2.36s/it]Best trial: 1. Best value: 0.965682:  35%|███▌      | 7/20 [00:18<00:30,  2.36s/it]Best trial: 1. Best value: 0.965682:  40%|████      | 8/20 [00:18<00:22,  1.89s/it]                                                                                   Best trial: 1. Best value: 0.965682:  40%|████      | 8/20 [00:20<00:22,  1.89s/it]Best trial: 1. Best value: 0.965682:  40%|████      | 8/20 [00:20<00:22,  1.89s/it]Best trial: 1. Best value: 0.965682:  45%|████▌     | 9/20 [00:20<00:19,  1.82s/it]                                                                                   Best trial: 1. Best value: 0.965682:  45%|████▌     | 9/20 [00:22<00:19,  1.82s/it]Best trial: 1. Best value: 0.965682:  45%|████▌     | 9/20 [00:22<00:19,  1.82s/it]Best trial: 1. Best value: 0.965682:  50%|█████     | 10/20 [00:22<00:18,  1.82s/it]                                                                                    Best trial: 1. Best value: 0.965682:  50%|█████     | 10/20 [00:24<00:18,  1.82s/it]Best trial: 1. Best value: 0.965682:  50%|█████     | 10/20 [00:24<00:18,  1.82s/it]Best trial: 1. Best value: 0.965682:  55%|█████▌    | 11/20 [00:24<00:18,  2.03s/it]                                                                                    Best trial: 1. Best value: 0.965682:  55%|█████▌    | 11/20 [00:27<00:18,  2.03s/it]Best trial: 1. Best value: 0.965682:  55%|█████▌    | 11/20 [00:27<00:18,  2.03s/it]Best trial: 1. Best value: 0.965682:  60%|██████    | 12/20 [00:27<00:17,  2.17s/it]                                                                                    Best trial: 1. Best value: 0.965682:  60%|██████    | 12/20 [00:31<00:17,  2.17s/it]Best trial: 1. Best value: 0.965682:  60%|██████    | 12/20 [00:31<00:17,  2.17s/it]Best trial: 1. Best value: 0.965682:  65%|██████▌   | 13/20 [00:31<00:20,  2.95s/it]                                                                                    Best trial: 1. Best value: 0.965682:  65%|██████▌   | 13/20 [00:34<00:20,  2.95s/it]Best trial: 1. Best value: 0.965682:  65%|██████▌   | 13/20 [00:34<00:20,  2.95s/it]Best trial: 1. Best value: 0.965682:  70%|███████   | 14/20 [00:34<00:17,  2.95s/it]                                                                                    Best trial: 1. Best value: 0.965682:  70%|███████   | 14/20 [00:36<00:17,  2.95s/it]Best trial: 1. Best value: 0.965682:  70%|███████   | 14/20 [00:36<00:17,  2.95s/it]Best trial: 1. Best value: 0.965682:  75%|███████▌  | 15/20 [00:36<00:13,  2.61s/it]                                                                                    Best trial: 1. Best value: 0.965682:  75%|███████▌  | 15/20 [00:38<00:13,  2.61s/it]Best trial: 15. Best value: 0.965814:  75%|███████▌  | 15/20 [00:38<00:13,  2.61s/it]Best trial: 15. Best value: 0.965814:  80%|████████  | 16/20 [00:38<00:10,  2.52s/it]                                                                                     Best trial: 15. Best value: 0.965814:  80%|████████  | 16/20 [00:40<00:10,  2.52s/it]Best trial: 16. Best value: 0.966696:  80%|████████  | 16/20 [00:40<00:10,  2.52s/it]Best trial: 16. Best value: 0.966696:  85%|████████▌ | 17/20 [00:40<00:06,  2.12s/it]                                                                                     Best trial: 16. Best value: 0.966696:  85%|████████▌ | 17/20 [00:41<00:06,  2.12s/it]Best trial: 16. Best value: 0.966696:  85%|████████▌ | 17/20 [00:41<00:06,  2.12s/it]Best trial: 16. Best value: 0.966696:  90%|█████████ | 18/20 [00:41<00:03,  1.91s/it]                                                                                     Best trial: 16. Best value: 0.966696:  90%|█████████ | 18/20 [00:43<00:03,  1.91s/it]Best trial: 18. Best value: 0.967296:  90%|█████████ | 18/20 [00:43<00:03,  1.91s/it]Best trial: 18. Best value: 0.967296:  95%|█████████▌| 19/20 [00:43<00:01,  1.92s/it]                                                                                     Best trial: 18. Best value: 0.967296:  95%|█████████▌| 19/20 [00:45<00:01,  1.92s/it]Best trial: 18. Best value: 0.967296:  95%|█████████▌| 19/20 [00:45<00:01,  1.92s/it]Best trial: 18. Best value: 0.967296: 100%|██████████| 20/20 [00:45<00:00,  1.89s/it]Best trial: 18. Best value: 0.967296: 100%|██████████| 20/20 [00:45<00:00,  2.27s/it]
2025-11-23 22:14:22,800 - INFO - Best LightGBM params: {'n_estimators': 623, 'learning_rate': 0.02414098496436694, 'num_leaves': 23, 'max_depth': 4, 'reg_alpha': 0.0031735995986113623, 'reg_lambda': 0.002811112753969392, 'subsample': 0.9282017285171342, 'colsample_bytree': 0.6204563250057121}
2025-11-23 22:14:24,214 - INFO - LightGBM model trained.
2025-11-23 22:14:24,215 - INFO - Training XGBoost model...
2025-11-23 22:14:24,263 - INFO - Optimizing XGBoost hyperparameters (20 trials)...
[I 2025-11-23 22:14:24,267] A new study created in memory with name: xgboost_optimization
[I 2025-11-23 22:13:40,101] Trial 0 finished with value: 0.961615436718267 and parameters: {'n_estimators': 1067, 'learning_rate': 0.01930764829978688, 'num_leaves': 30, 'max_depth': 6, 'reg_alpha': 0.03491661554592054, 'reg_lambda': 0.006097311418805001, 'subsample': 0.8166678374605245, 'colsample_bytree': 0.954454880347744}. Best is trial 0 with value: 0.961615436718267.
[I 2025-11-23 22:13:42,913] Trial 1 finished with value: 0.9656820196493628 and parameters: {'n_estimators': 1250, 'learning_rate': 0.028178214698967228, 'num_leaves': 75, 'max_depth': 6, 'reg_alpha': 0.011433598347960549, 'reg_lambda': 0.006302702719846417, 'subsample': 0.6506661470564297, 'colsample_bytree': 0.7724802879524684}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:13:45,458] Trial 2 finished with value: 0.9539255454868281 and parameters: {'n_estimators': 1318, 'learning_rate': 0.06250334344882857, 'num_leaves': 96, 'max_depth': 9, 'reg_alpha': 0.07060600719353452, 'reg_lambda': 0.054278674320657506, 'subsample': 0.8374791653640108, 'colsample_bytree': 0.9082761944257614}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:13:47,985] Trial 3 finished with value: 0.9633050517538437 and parameters: {'n_estimators': 1046, 'learning_rate': 0.044552391971625235, 'num_leaves': 47, 'max_depth': 7, 'reg_alpha': 0.012852460117268838, 'reg_lambda': 0.023342250871923296, 'subsample': 0.5142212278422795, 'colsample_bytree': 0.9440311558966481}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:13:50,832] Trial 4 finished with value: 0.9601405442373706 and parameters: {'n_estimators': 1433, 'learning_rate': 0.03415623003000661, 'num_leaves': 88, 'max_depth': 10, 'reg_alpha': 0.31023455754530715, 'reg_lambda': 0.034929636610588705, 'subsample': 0.639602739896685, 'colsample_bytree': 0.6882217971032717}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:13:53,572] Trial 5 finished with value: 0.9305677929320164 and parameters: {'n_estimators': 1497, 'learning_rate': 0.05528708255379167, 'num_leaves': 34, 'max_depth': 4, 'reg_alpha': 0.4327986557746175, 'reg_lambda': 0.007773270512420007, 'subsample': 0.6457279533682875, 'colsample_bytree': 0.5395504912868241}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:13:55,210] Trial 6 finished with value: 0.9600264358896795 and parameters: {'n_estimators': 722, 'learning_rate': 0.01551664365057586, 'num_leaves': 60, 'max_depth': 10, 'reg_alpha': 1.1118387550367128, 'reg_lambda': 0.10155684246581569, 'subsample': 0.7589259923098312, 'colsample_bytree': 0.6388749694025304}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:13:56,096] Trial 7 finished with value: 0.9560827601173175 and parameters: {'n_estimators': 326, 'learning_rate': 0.07323873113480053, 'num_leaves': 32, 'max_depth': 8, 'reg_alpha': 1.4072618181850718, 'reg_lambda': 8.103058961387806, 'subsample': 0.5953754702311351, 'colsample_bytree': 0.8785463880742982}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:13:57,746] Trial 8 finished with value: 0.7261663619744059 and parameters: {'n_estimators': 1292, 'learning_rate': 0.05711125508185419, 'num_leaves': 92, 'max_depth': 8, 'reg_alpha': 8.113047298002225, 'reg_lambda': 0.0010725412888920648, 'subsample': 0.5298863365525592, 'colsample_bytree': 0.5288892317320939}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:13:59,589] Trial 9 finished with value: 0.958496047768732 and parameters: {'n_estimators': 1009, 'learning_rate': 0.07174859141735798, 'num_leaves': 40, 'max_depth': 10, 'reg_alpha': 0.9656396801184871, 'reg_lambda': 0.6275552749465074, 'subsample': 0.6305755387500603, 'colsample_bytree': 0.5425523023242598}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:14:02,097] Trial 10 finished with value: 0.960191022319256 and parameters: {'n_estimators': 767, 'learning_rate': 0.022438023677004766, 'num_leaves': 75, 'max_depth': 5, 'reg_alpha': 0.0011128641681426546, 'reg_lambda': 0.0010069524376354966, 'subsample': 0.9374092618354561, 'colsample_bytree': 0.7854234960487197}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:14:04,584] Trial 11 finished with value: 0.9609123406941722 and parameters: {'n_estimators': 1083, 'learning_rate': 0.033461829994958885, 'num_leaves': 59, 'max_depth': 6, 'reg_alpha': 0.007141227650185046, 'reg_lambda': 0.00834104962055728, 'subsample': 0.5169899814248634, 'colsample_bytree': 0.7765043843058165}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:14:09,329] Trial 12 finished with value: 0.9552963647363644 and parameters: {'n_estimators': 1186, 'learning_rate': 0.010616992200918314, 'num_leaves': 74, 'max_depth': 7, 'reg_alpha': 0.006519784184292616, 'reg_lambda': 0.11490763321215466, 'subsample': 0.7110579565501207, 'colsample_bytree': 0.9869173845810033}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:14:12,293] Trial 13 finished with value: 0.9517144003261742 and parameters: {'n_estimators': 850, 'learning_rate': 0.041623967193444654, 'num_leaves': 48, 'max_depth': 6, 'reg_alpha': 0.013979659840380708, 'reg_lambda': 0.5157583074571291, 'subsample': 0.5393068839663402, 'colsample_bytree': 0.8718409439649096}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:14:14,120] Trial 14 finished with value: 0.9179591361645602 and parameters: {'n_estimators': 621, 'learning_rate': 0.09697829627261946, 'num_leaves': 74, 'max_depth': 7, 'reg_alpha': 0.0014997030053609504, 'reg_lambda': 0.017819497405162706, 'subsample': 0.708412078473807, 'colsample_bytree': 0.8241942319192102}. Best is trial 1 with value: 0.9656820196493628.
[I 2025-11-23 22:14:16,410] Trial 15 finished with value: 0.965814396380519 and parameters: {'n_estimators': 934, 'learning_rate': 0.02398377262785754, 'num_leaves': 49, 'max_depth': 4, 'reg_alpha': 0.02195606164258883, 'reg_lambda': 0.0032582684447066395, 'subsample': 0.5817325997774011, 'colsample_bytree': 0.6742519633434855}. Best is trial 15 with value: 0.965814396380519.
[I 2025-11-23 22:14:17,614] Trial 16 finished with value: 0.9666960135730538 and parameters: {'n_estimators': 417, 'learning_rate': 0.023610906769325132, 'num_leaves': 22, 'max_depth': 4, 'reg_alpha': 0.04927731317492115, 'reg_lambda': 0.002612629825167515, 'subsample': 0.5867893792547706, 'colsample_bytree': 0.6966466136680141}. Best is trial 16 with value: 0.9666960135730538.
[I 2025-11-23 22:14:19,021] Trial 17 finished with value: 0.9632263753896334 and parameters: {'n_estimators': 465, 'learning_rate': 0.013980433779322942, 'num_leaves': 21, 'max_depth': 4, 'reg_alpha': 0.09616299787472352, 'reg_lambda': 0.003017570900165075, 'subsample': 0.5785653978595254, 'colsample_bytree': 0.6951754062763891}. Best is trial 16 with value: 0.9666960135730538.
[I 2025-11-23 22:14:20,959] Trial 18 finished with value: 0.9672958320729158 and parameters: {'n_estimators': 623, 'learning_rate': 0.02414098496436694, 'num_leaves': 23, 'max_depth': 4, 'reg_alpha': 0.0031735995986113623, 'reg_lambda': 0.002811112753969392, 'subsample': 0.9282017285171342, 'colsample_bytree': 0.6204563250057121}. Best is trial 18 with value: 0.9672958320729158.
[I 2025-11-23 22:14:22,799] Trial 19 finished with value: 0.9666384201596674 and parameters: {'n_estimators': 510, 'learning_rate': 0.016869540063819397, 'num_leaves': 22, 'max_depth': 5, 'reg_alpha': 0.003125759440475529, 'reg_lambda': 0.002325487612160863, 'subsample': 0.9464268127665039, 'colsample_bytree': 0.6033345519513174}. Best is trial 18 with value: 0.9672958320729158.
  0%|          | 0/20 [00:00<?, ?it/s]                                        0%|          | 0/20 [00:01<?, ?it/s]Best trial: 0. Best value: 0.9718:   0%|          | 0/20 [00:01<?, ?it/s]Best trial: 0. Best value: 0.9718:   5%|▌         | 1/20 [00:01<00:21,  1.15s/it]                                                                                 Best trial: 0. Best value: 0.9718:   5%|▌         | 1/20 [00:02<00:21,  1.15s/it]Best trial: 0. Best value: 0.9718:   5%|▌         | 1/20 [00:02<00:21,  1.15s/it]Best trial: 0. Best value: 0.9718:  10%|█         | 2/20 [00:02<00:18,  1.02s/it]                                                                                 Best trial: 0. Best value: 0.9718:  10%|█         | 2/20 [00:03<00:18,  1.02s/it]Best trial: 0. Best value: 0.9718:  10%|█         | 2/20 [00:03<00:18,  1.02s/it]Best trial: 0. Best value: 0.9718:  15%|█▌        | 3/20 [00:03<00:22,  1.35s/it]                                                                                 Best trial: 0. Best value: 0.9718:  15%|█▌        | 3/20 [00:04<00:22,  1.35s/it]Best trial: 0. Best value: 0.9718:  15%|█▌        | 3/20 [00:04<00:22,  1.35s/it]Best trial: 0. Best value: 0.9718:  20%|██        | 4/20 [00:04<00:19,  1.22s/it]                                                                                 Best trial: 0. Best value: 0.9718:  20%|██        | 4/20 [00:05<00:19,  1.22s/it]Best trial: 4. Best value: 0.972219:  20%|██        | 4/20 [00:05<00:19,  1.22s/it]Best trial: 4. Best value: 0.972219:  25%|██▌       | 5/20 [00:05<00:16,  1.12s/it]                                                                                   Best trial: 4. Best value: 0.972219:  25%|██▌       | 5/20 [00:07<00:16,  1.12s/it]Best trial: 4. Best value: 0.972219:  25%|██▌       | 5/20 [00:07<00:16,  1.12s/it]Best trial: 4. Best value: 0.972219:  30%|███       | 6/20 [00:07<00:18,  1.36s/it]                                                                                   Best trial: 4. Best value: 0.972219:  30%|███       | 6/20 [00:08<00:18,  1.36s/it]Best trial: 6. Best value: 0.972416:  30%|███       | 6/20 [00:08<00:18,  1.36s/it]Best trial: 6. Best value: 0.972416:  35%|███▌      | 7/20 [00:08<00:14,  1.14s/it]                                                                                   Best trial: 6. Best value: 0.972416:  35%|███▌      | 7/20 [00:09<00:14,  1.14s/it]Best trial: 7. Best value: 0.972914:  35%|███▌      | 7/20 [00:09<00:14,  1.14s/it]Best trial: 7. Best value: 0.972914:  40%|████      | 8/20 [00:09<00:14,  1.25s/it]                                                                                   Best trial: 7. Best value: 0.972914:  40%|████      | 8/20 [00:10<00:14,  1.25s/it]Best trial: 7. Best value: 0.972914:  40%|████      | 8/20 [00:10<00:14,  1.25s/it]Best trial: 7. Best value: 0.972914:  45%|████▌     | 9/20 [00:10<00:13,  1.18s/it]                                                                                   Best trial: 7. Best value: 0.972914:  45%|████▌     | 9/20 [00:12<00:13,  1.18s/it]Best trial: 7. Best value: 0.972914:  45%|████▌     | 9/20 [00:12<00:13,  1.18s/it]Best trial: 7. Best value: 0.972914:  50%|█████     | 10/20 [00:12<00:11,  1.20s/it]                                                                                    Best trial: 7. Best value: 0.972914:  50%|█████     | 10/20 [00:13<00:11,  1.20s/it]Best trial: 7. Best value: 0.972914:  50%|█████     | 10/20 [00:13<00:11,  1.20s/it]Best trial: 7. Best value: 0.972914:  55%|█████▌    | 11/20 [00:13<00:12,  1.36s/it]                                                                                    Best trial: 7. Best value: 0.972914:  55%|█████▌    | 11/20 [00:14<00:12,  1.36s/it]Best trial: 7. Best value: 0.972914:  55%|█████▌    | 11/20 [00:14<00:12,  1.36s/it]Best trial: 7. Best value: 0.972914:  60%|██████    | 12/20 [00:14<00:09,  1.13s/it]                                                                                    Best trial: 7. Best value: 0.972914:  60%|██████    | 12/20 [00:14<00:09,  1.13s/it]Best trial: 7. Best value: 0.972914:  60%|██████    | 12/20 [00:14<00:09,  1.13s/it]Best trial: 7. Best value: 0.972914:  65%|██████▌   | 13/20 [00:14<00:06,  1.04it/s]                                                                                    Best trial: 7. Best value: 0.972914:  65%|██████▌   | 13/20 [00:16<00:06,  1.04it/s]Best trial: 7. Best value: 0.972914:  65%|██████▌   | 13/20 [00:16<00:06,  1.04it/s]Best trial: 7. Best value: 0.972914:  70%|███████   | 14/20 [00:16<00:07,  1.18s/it]                                                                                    Best trial: 7. Best value: 0.972914:  70%|███████   | 14/20 [00:17<00:07,  1.18s/it]Best trial: 14. Best value: 0.975035:  70%|███████   | 14/20 [00:17<00:07,  1.18s/it]Best trial: 14. Best value: 0.975035:  75%|███████▌  | 15/20 [00:17<00:05,  1.04s/it]                                                                                     Best trial: 14. Best value: 0.975035:  75%|███████▌  | 15/20 [00:18<00:05,  1.04s/it]Best trial: 14. Best value: 0.975035:  75%|███████▌  | 15/20 [00:18<00:05,  1.04s/it]Best trial: 14. Best value: 0.975035:  80%|████████  | 16/20 [00:18<00:03,  1.04it/s]                                                                                     Best trial: 14. Best value: 0.975035:  80%|████████  | 16/20 [00:19<00:03,  1.04it/s]Best trial: 14. Best value: 0.975035:  80%|████████  | 16/20 [00:19<00:03,  1.04it/s]Best trial: 14. Best value: 0.975035:  85%|████████▌ | 17/20 [00:19<00:03,  1.10s/it]                                                                                     Best trial: 14. Best value: 0.975035:  85%|████████▌ | 17/20 [00:21<00:03,  1.10s/it]Best trial: 14. Best value: 0.975035:  85%|████████▌ | 17/20 [00:21<00:03,  1.10s/it]Best trial: 14. Best value: 0.975035:  90%|█████████ | 18/20 [00:21<00:02,  1.25s/it]                                                                                     Best trial: 14. Best value: 0.975035:  90%|█████████ | 18/20 [00:22<00:02,  1.25s/it]Best trial: 14. Best value: 0.975035:  90%|█████████ | 18/20 [00:22<00:02,  1.25s/it]Best trial: 14. Best value: 0.975035:  95%|█████████▌| 19/20 [00:22<00:01,  1.18s/it]                                                                                     Best trial: 14. Best value: 0.975035:  95%|█████████▌| 19/20 [00:23<00:01,  1.18s/it]Best trial: 14. Best value: 0.975035:  95%|█████████▌| 19/20 [00:23<00:01,  1.18s/it]Best trial: 14. Best value: 0.975035: 100%|██████████| 20/20 [00:23<00:00,  1.18s/it]Best trial: 14. Best value: 0.975035: 100%|██████████| 20/20 [00:23<00:00,  1.17s/it]
2025-11-23 22:14:47,612 - INFO - Best XGBoost params: {'n_estimators': 517, 'learning_rate': 0.01522457855148051, 'max_depth': 10, 'reg_alpha': 1.6221614894205878, 'reg_lambda': 1.886127359157041, 'subsample': 0.8507337457359188, 'colsample_bytree': 0.7316660987867394, 'gamma': 4.955208420083158}
2025-11-23 22:14:47,912 - INFO - XGBoost model trained.
2025-11-23 22:14:47,912 - INFO - Training Stacking Ensemble (3 base models)...
2025-11-23 22:14:47,914 - INFO - Generating out-of-fold predictions...
2025-11-23 22:14:55,264 - INFO - Stacking Meta-Model Coefficients: [[2.18968564 0.45177982 3.37592114]]
2025-11-23 22:14:55,265 - INFO - Saving models to models/...
2025-11-23 22:14:55,283 - INFO - Models saved successfully.
2025-11-23 22:14:55,283 - INFO - Generating SHAP explanations...
2025-11-23 22:14:55,286 - INFO - Generating SHAP explanation...
2025-11-23 22:14:56,116 - INFO - SHAP summary saved to shap_summary.png
2025-11-23 22:14:56,117 - INFO - Using Fraud Threshold from config: 0.5
2025-11-23 22:14:56,117 - INFO - 
============================================================
2025-11-23 22:14:56,117 - INFO - TRAIN SET METRICS (reference only):
2025-11-23 22:14:56,117 - INFO - ============================================================
2025-11-23 22:14:56,119 - INFO - Calculating business metrics...
2025-11-23 22:14:56,177 - INFO - Saved Money: 0.00
2025-11-23 22:14:56,177 - INFO - Lost Money: 21,048,997.37
2025-11-23 22:14:56,177 - INFO - Blocked Legit Money: 0.00
2025-11-23 22:14:56,177 - INFO - 
============================================================
2025-11-23 22:14:56,177 - INFO - HOLDOUT TEST SET METRICS (final evaluation):
2025-11-23 22:14:56,177 - INFO - ============================================================
2025-11-23 22:14:56,180 - INFO - Analyzing data drift...
2025-11-23 22:14:56,184 - INFO - 
============================================================
2025-11-23 22:14:56,184 - INFO - TOP 10 DRIFTING FEATURES:
2025-11-23 22:14:56,184 - INFO - ============================================================
2025-11-23 22:14:56,184 - INFO - monthly_os_changes: score=0.3655 (Train: 1.38 -> Holdout: 1.12)
2025-11-23 22:14:56,184 - INFO - monthly_phone_model_changes: score=0.3162 (Train: 1.32 -> Holdout: 1.13)
2025-11-23 22:14:56,184 - INFO - logins_last_30_days: score=0.2866 (Train: 45.52 -> Holdout: 33.37)
2025-11-23 22:14:56,184 - INFO - high_risk_device: score=0.2736 (Train: 0.31 -> Holdout: 0.18)
2025-11-23 22:14:56,184 - INFO - is_fake_os: score=0.2185 (Train: 0.00 -> Holdout: 0.01)
2025-11-23 22:14:56,184 - INFO - zscore_avg_login_interval_7d: score=0.2082 (Train: -0.19 -> Holdout: -0.30)
2025-11-23 22:14:56,184 - INFO - fano_factor_login_interval: score=0.1789 (Train: 226425.73 -> Holdout: 275210.03)
2025-11-23 22:14:56,184 - INFO - logins_last_7_days: score=0.1656 (Train: 12.08 -> Holdout: 9.95)
2025-11-23 22:14:56,184 - INFO - direction_txn_count: score=0.1529 (Train: 59.25 -> Holdout: 50.03)
2025-11-23 22:14:56,184 - INFO - time_since_last_txn: score=0.1516 (Train: 408746.53 -> Holdout: 532849.48)
2025-11-23 22:14:56,184 - INFO - ============================================================

2025-11-23 22:14:56,184 - INFO - 
============================================================
2025-11-23 22:14:56,184 - INFO - LLM EXPLAINER AGENT (Top 3 Suspicious Cases in Holdout)
2025-11-23 22:14:56,184 - INFO - ============================================================
2025-11-23 22:14:56,185 - INFO - Generating explanations for top 3 fraud cases...
2025-11-23 22:14:56,278 - INFO - 
### Case #1 (Transaction ID: 12363)
**Risk Score:** 0.9046
**Key Risk Factors:**
- **direction_txn_count**: 1.00
- **amount_to_avg_30d**: 111.84
- **Transaction Amount**: 500000.00


### Case #2 (Transaction ID: 12691)
**Risk Score:** 0.8587
**Key Risk Factors:**
- **direction_txn_count**: 1.00
- **amount_to_avg_30d**: 20.73
- **Transaction Amount**: 90000.00


### Case #3 (Transaction ID: 12000)
**Risk Score:** 0.8584
**Key Risk Factors:**
- **direction_txn_count**: 1.00
- **amount_to_avg_30d**: 15.14
- **Transaction Amount**: 301257.00

2025-11-23 22:14:56,278 - INFO - ============================================================

2025-11-23 22:14:56,279 - INFO - Calculating business metrics...
2025-11-23 22:14:56,294 - INFO - Saved Money: 0.00
2025-11-23 22:14:56,294 - INFO - Lost Money: 16,018,157.00
2025-11-23 22:14:56,294 - INFO - Blocked Legit Money: 0.00
2025-11-23 22:14:56,294 - INFO - 
============================================================
2025-11-23 22:14:56,294 - INFO - SUMMARY:
2025-11-23 22:14:56,294 - INFO - ============================================================
2025-11-23 22:14:56,294 - INFO - Train Set Saved: 0.00 KZT
2025-11-23 22:14:56,294 - INFO - Holdout Set Saved: 0.00 KZT
2025-11-23 22:14:56,294 - INFO - Holdout Set Lost: 16,018,157.00 KZT
2025-11-23 22:14:56,294 - INFO - ============================================================

[I 2025-11-23 22:14:25,418] Trial 0 finished with value: 0.9718004813699315 and parameters: {'n_estimators': 815, 'learning_rate': 0.025298138757568128, 'max_depth': 5, 'reg_alpha': 0.844567754444742, 'reg_lambda': 0.10363239531199503, 'subsample': 0.7837596700196332, 'colsample_bytree': 0.9380864500948678, 'gamma': 1.7816211335104675}. Best is trial 0 with value: 0.9718004813699315.
[I 2025-11-23 22:14:26,340] Trial 1 finished with value: 0.971338931779622 and parameters: {'n_estimators': 722, 'learning_rate': 0.03362816249520186, 'max_depth': 4, 'reg_alpha': 0.455445253314233, 'reg_lambda': 0.04729092897830933, 'subsample': 0.92179151045783, 'colsample_bytree': 0.7994057500043398, 'gamma': 4.567537150197234}. Best is trial 0 with value: 0.9718004813699315.
[I 2025-11-23 22:14:28,084] Trial 2 finished with value: 0.9716065918745809 and parameters: {'n_estimators': 1414, 'learning_rate': 0.06395276159776092, 'max_depth': 7, 'reg_alpha': 0.218441259835995, 'reg_lambda': 0.5642930355370764, 'subsample': 0.9579007889087772, 'colsample_bytree': 0.5862400306977138, 'gamma': 2.0338351460488724}. Best is trial 0 with value: 0.9718004813699315.
[I 2025-11-23 22:14:29,115] Trial 3 finished with value: 0.9684761353622768 and parameters: {'n_estimators': 771, 'learning_rate': 0.08141692058209077, 'max_depth': 4, 'reg_alpha': 0.04986273245165651, 'reg_lambda': 0.7684685954411421, 'subsample': 0.7806953305564696, 'colsample_bytree': 0.6031365320815982, 'gamma': 2.912897885760807}. Best is trial 0 with value: 0.9718004813699315.
[I 2025-11-23 22:14:30,039] Trial 4 finished with value: 0.9722187734273275 and parameters: {'n_estimators': 619, 'learning_rate': 0.04038778559479216, 'max_depth': 9, 'reg_alpha': 0.025298394683601202, 'reg_lambda': 1.6677807846135604, 'subsample': 0.5069716155241984, 'colsample_bytree': 0.7389477251981069, 'gamma': 2.9612220178245985}. Best is trial 4 with value: 0.9722187734273275.
[I 2025-11-23 22:14:31,862] Trial 5 finished with value: 0.9686570962608341 and parameters: {'n_estimators': 1465, 'learning_rate': 0.06837661877781613, 'max_depth': 4, 'reg_alpha': 0.256809328429737, 'reg_lambda': 0.04830079303609958, 'subsample': 0.9606978401556441, 'colsample_bytree': 0.5239367583276421, 'gamma': 3.0740052505153734}. Best is trial 4 with value: 0.9722187734273275.
[I 2025-11-23 22:14:32,553] Trial 6 finished with value: 0.9724162929254403 and parameters: {'n_estimators': 392, 'learning_rate': 0.012198718304190517, 'max_depth': 5, 'reg_alpha': 0.7883085105303649, 'reg_lambda': 0.4048691791835189, 'subsample': 0.8414225534401724, 'colsample_bytree': 0.7918169929389917, 'gamma': 0.46653303107038413}. Best is trial 6 with value: 0.9724162929254403.
[I 2025-11-23 22:14:34,034] Trial 7 finished with value: 0.9729135112385412 and parameters: {'n_estimators': 931, 'learning_rate': 0.010330453986700076, 'max_depth': 5, 'reg_alpha': 0.01572130387774135, 'reg_lambda': 4.6507443017597545, 'subsample': 0.6651792981865948, 'colsample_bytree': 0.8980707331069075, 'gamma': 2.3930904780602145}. Best is trial 7 with value: 0.9729135112385412.
[I 2025-11-23 22:14:35,073] Trial 8 finished with value: 0.9671988347165047 and parameters: {'n_estimators': 786, 'learning_rate': 0.04588880325948149, 'max_depth': 7, 'reg_alpha': 0.012981285720122818, 'reg_lambda': 0.0047365610067269855, 'subsample': 0.9144610928003369, 'colsample_bytree': 0.6783602326004481, 'gamma': 2.783139238598606}. Best is trial 7 with value: 0.9729135112385412.
[I 2025-11-23 22:14:36,299] Trial 9 finished with value: 0.7261170018281535 and parameters: {'n_estimators': 987, 'learning_rate': 0.05485293303579688, 'max_depth': 9, 'reg_alpha': 4.933306455993916, 'reg_lambda': 0.016858813546559548, 'subsample': 0.7652317632446488, 'colsample_bytree': 0.7868960334293618, 'gamma': 3.625021702206483}. Best is trial 7 with value: 0.9729135112385412.
[I 2025-11-23 22:14:38,036] Trial 10 finished with value: 0.9709851511843541 and parameters: {'n_estimators': 1096, 'learning_rate': 0.011413628250688267, 'max_depth': 6, 'reg_alpha': 0.0024299950959813265, 'reg_lambda': 8.6577787549356, 'subsample': 0.5958556625190592, 'colsample_bytree': 0.9902254164554098, 'gamma': 0.671956303845902}. Best is trial 7 with value: 0.9729135112385412.
[I 2025-11-23 22:14:38,628] Trial 11 finished with value: 0.9621779950810831 and parameters: {'n_estimators': 365, 'learning_rate': 0.010257163492001668, 'max_depth': 6, 'reg_alpha': 3.1789243621368954, 'reg_lambda': 3.3964118902873253, 'subsample': 0.6589697235840141, 'colsample_bytree': 0.8879528951039602, 'gamma': 0.02487725743204816}. Best is trial 7 with value: 0.9729135112385412.
[I 2025-11-23 22:14:39,200] Trial 12 finished with value: 0.970125840095748 and parameters: {'n_estimators': 311, 'learning_rate': 0.01744989124662333, 'max_depth': 5, 'reg_alpha': 0.0035570307864317206, 'reg_lambda': 0.23074708206308026, 'subsample': 0.6769397554429148, 'colsample_bytree': 0.8650851036516047, 'gamma': 0.8293279806737186}. Best is trial 7 with value: 0.9729135112385412.
[I 2025-11-23 22:14:40,894] Trial 13 finished with value: 0.9723675640840161 and parameters: {'n_estimators': 1171, 'learning_rate': 0.015786201535130242, 'max_depth': 6, 'reg_alpha': 0.009579670229787188, 'reg_lambda': 9.820549550149325, 'subsample': 0.829784390504975, 'colsample_bytree': 0.8569523072747455, 'gamma': 1.384322260001508}. Best is trial 7 with value: 0.9729135112385412.
[I 2025-11-23 22:14:41,596] Trial 14 finished with value: 0.9750354780161246 and parameters: {'n_estimators': 517, 'learning_rate': 0.01522457855148051, 'max_depth': 10, 'reg_alpha': 1.6221614894205878, 'reg_lambda': 1.886127359157041, 'subsample': 0.8507337457359188, 'colsample_bytree': 0.7316660987867394, 'gamma': 4.955208420083158}. Best is trial 14 with value: 0.9750354780161246.
[I 2025-11-23 22:14:42,390] Trial 15 finished with value: 0.9715880604474373 and parameters: {'n_estimators': 554, 'learning_rate': 0.02082032260322261, 'max_depth': 10, 'reg_alpha': 0.0010333255817264913, 'reg_lambda': 2.6268997344084997, 'subsample': 0.681196958321183, 'colsample_bytree': 0.6882597624740605, 'gamma': 4.776491161297384}. Best is trial 14 with value: 0.9750354780161246.
[I 2025-11-23 22:14:43,813] Trial 16 finished with value: 0.9723712466955139 and parameters: {'n_estimators': 980, 'learning_rate': 0.013830327001570811, 'max_depth': 8, 'reg_alpha': 0.0871173364891241, 'reg_lambda': 2.739813865864922, 'subsample': 0.5860849632903264, 'colsample_bytree': 0.7182144514287057, 'gamma': 4.002438823319499}. Best is trial 14 with value: 0.9750354780161246.
[I 2025-11-23 22:14:45,394] Trial 17 finished with value: 0.9727896242421054 and parameters: {'n_estimators': 1271, 'learning_rate': 0.023692778443796553, 'max_depth': 10, 'reg_alpha': 2.341416395632309, 'reg_lambda': 1.4240838813593382, 'subsample': 0.8579359682298778, 'colsample_bytree': 0.6360939492942095, 'gamma': 2.1984349350848036}. Best is trial 14 with value: 0.9750354780161246.
[I 2025-11-23 22:14:46,424] Trial 18 finished with value: 0.9724528033880026 and parameters: {'n_estimators': 535, 'learning_rate': 0.018434174545605725, 'max_depth': 8, 'reg_alpha': 0.0454015494088, 'reg_lambda': 0.0010309873920587346, 'subsample': 0.7111621138807483, 'colsample_bytree': 0.9927088341402737, 'gamma': 4.011318462724954}. Best is trial 14 with value: 0.9750354780161246.
[I 2025-11-23 22:14:47,611] Trial 19 finished with value: 0.7121572212065814 and parameters: {'n_estimators': 914, 'learning_rate': 0.014445757222044326, 'max_depth': 8, 'reg_alpha': 8.366613539092226, 'reg_lambda': 0.2037774045963855, 'subsample': 0.6058076676287091, 'colsample_bytree': 0.9233958606431193, 'gamma': 1.3950252848644162}. Best is trial 14 with value: 0.9750354780161246.
