2025-11-22 16:16:22,649 - INFO - Starting ForteBank AI Hackathon Pipeline...
2025-11-22 16:16:22,649 - INFO - Loading data...
2025-11-22 16:16:22,684 - INFO - Loaded behavior data: (8587, 19)
2025-11-22 16:16:22,684 - INFO - Loaded transactions data: (13113, 7)
2025-11-22 16:16:22,684 - INFO - Cleaning data...
2025-11-22 16:16:22,697 - INFO - Merging data...
2025-11-22 16:16:22,697 - INFO - Transactions dtypes: transdatetime=datetime64[ns], cst_dim_id=int64
2025-11-22 16:16:22,697 - INFO - Behavior dtypes: transdate=datetime64[ns], cst_dim_id=int64
2025-11-22 16:16:22,703 - INFO - Merged data shape: (13107, 28)
2025-11-22 16:16:22,707 - INFO - Generating features...
2025-11-22 16:16:22,707 - INFO - Generating velocity features...
2025-11-22 16:16:22,737 - INFO - Generating interaction features...
2025-11-22 16:16:22,738 - INFO - Generating identity features...
2025-11-22 16:16:22,743 - INFO - Generating graph features...
2025-11-22 16:16:22,749 - INFO - Generating time delta features...
2025-11-22 16:16:22,750 - INFO - Generating GNN embeddings...
2025-11-22 16:16:22,752 - INFO - Building transaction graph for embeddings...
2025-11-22 16:16:22,754 - INFO - Graph has 2291 nodes (clients + receivers).
2025-11-22 16:16:22,759 - INFO - Generating graph embeddings via TruncatedSVD...
2025-11-22 16:16:22,785 - INFO - Embeddings generated. Explained variance: 0.3792
2025-11-22 16:16:22,791 - INFO - Generating anomaly features (Isolation Forest)...
2025-11-22 16:16:22,933 - INFO - 
============================================================
2025-11-22 16:16:22,933 - INFO - DATA SPLIT:
2025-11-22 16:16:22,934 - INFO - Train set: 11141 transactions (2024-11-30 05:45:05 to 2025-07-07 15:19:13)
2025-11-22 16:16:22,934 - INFO - Holdout set: 1966 transactions (2025-07-07 15:24:01 to 2025-08-29 22:12:01)
2025-11-22 16:16:22,934 - INFO - Train fraud rate: 0.0056
2025-11-22 16:16:22,934 - INFO - Holdout fraud rate: 0.0524
2025-11-22 16:16:22,934 - INFO - ============================================================

2025-11-22 16:16:22,943 - INFO - 
============================================================
2025-11-22 16:16:22,943 - INFO - HYPERPARAMETER OPTIMIZATION WITH OPTUNA
2025-11-22 16:16:22,943 - INFO - ============================================================

2025-11-22 16:16:22,943 - INFO - Training final CatBoost model...
2025-11-22 16:16:22,985 - INFO - Optimizing CatBoost hyperparameters (15 trials)...
[I 2025-11-22 16:16:22,986] A new study created in memory with name: catboost_optimization
  0%|          | 0/15 [00:00<?, ?it/s]                                        0%|          | 0/15 [00:08<?, ?it/s]Best trial: 0. Best value: 0.940919:   0%|          | 0/15 [00:08<?, ?it/s]Best trial: 0. Best value: 0.940919:   7%|▋         | 1/15 [00:08<02:04,  8.92s/it]                                                                                   Best trial: 0. Best value: 0.940919:   7%|▋         | 1/15 [00:18<02:04,  8.92s/it]Best trial: 1. Best value: 0.956217:   7%|▋         | 1/15 [00:18<02:04,  8.92s/it]Best trial: 1. Best value: 0.956217:  13%|█▎        | 2/15 [00:18<02:03,  9.46s/it]                                                                                   Best trial: 1. Best value: 0.956217:  13%|█▎        | 2/15 [00:26<02:03,  9.46s/it]Best trial: 1. Best value: 0.956217:  13%|█▎        | 2/15 [00:26<02:03,  9.46s/it]Best trial: 1. Best value: 0.956217:  20%|██        | 3/15 [00:26<01:41,  8.49s/it]                                                                                   Best trial: 1. Best value: 0.956217:  20%|██        | 3/15 [00:43<01:41,  8.49s/it]Best trial: 1. Best value: 0.956217:  20%|██        | 3/15 [00:43<01:41,  8.49s/it]Best trial: 1. Best value: 0.956217:  27%|██▋       | 4/15 [00:43<02:11, 11.96s/it]                                                                                   Best trial: 1. Best value: 0.956217:  27%|██▋       | 4/15 [00:49<02:11, 11.96s/it]Best trial: 1. Best value: 0.956217:  27%|██▋       | 4/15 [00:49<02:11, 11.96s/it]Best trial: 1. Best value: 0.956217:  33%|███▎      | 5/15 [00:49<01:37,  9.75s/it]                                                                                   Best trial: 1. Best value: 0.956217:  33%|███▎      | 5/15 [00:54<01:37,  9.75s/it]Best trial: 5. Best value: 0.963755:  33%|███▎      | 5/15 [00:54<01:37,  9.75s/it]Best trial: 5. Best value: 0.963755:  40%|████      | 6/15 [00:54<01:15,  8.35s/it]                                                                                   Best trial: 5. Best value: 0.963755:  40%|████      | 6/15 [01:01<01:15,  8.35s/it]Best trial: 5. Best value: 0.963755:  40%|████      | 6/15 [01:01<01:15,  8.35s/it]Best trial: 5. Best value: 0.963755:  47%|████▋     | 7/15 [01:01<01:02,  7.76s/it]                                                                                   Best trial: 5. Best value: 0.963755:  47%|████▋     | 7/15 [01:10<01:02,  7.76s/it]Best trial: 5. Best value: 0.963755:  47%|████▋     | 7/15 [01:10<01:02,  7.76s/it]Best trial: 5. Best value: 0.963755:  53%|█████▎    | 8/15 [01:10<00:57,  8.18s/it]                                                                                   Best trial: 5. Best value: 0.963755:  53%|█████▎    | 8/15 [01:22<00:57,  8.18s/it]Best trial: 5. Best value: 0.963755:  53%|█████▎    | 8/15 [01:22<00:57,  8.18s/it]Best trial: 5. Best value: 0.963755:  60%|██████    | 9/15 [01:22<00:56,  9.44s/it]                                                                                   Best trial: 5. Best value: 0.963755:  60%|██████    | 9/15 [01:36<00:56,  9.44s/it]Best trial: 5. Best value: 0.963755:  60%|██████    | 9/15 [01:36<00:56,  9.44s/it]Best trial: 5. Best value: 0.963755:  67%|██████▋   | 10/15 [01:36<00:54, 10.87s/it]                                                                                    Best trial: 5. Best value: 0.963755:  67%|██████▋   | 10/15 [01:38<00:54, 10.87s/it]Best trial: 5. Best value: 0.963755:  67%|██████▋   | 10/15 [01:38<00:54, 10.87s/it]Best trial: 5. Best value: 0.963755:  73%|███████▎  | 11/15 [01:38<00:32,  8.17s/it]                                                                                    Best trial: 5. Best value: 0.963755:  73%|███████▎  | 11/15 [01:43<00:32,  8.17s/it]Best trial: 5. Best value: 0.963755:  73%|███████▎  | 11/15 [01:43<00:32,  8.17s/it]Best trial: 5. Best value: 0.963755:  80%|████████  | 12/15 [01:43<00:21,  7.01s/it]                                                                                    Best trial: 5. Best value: 0.963755:  80%|████████  | 12/15 [01:48<00:21,  7.01s/it]Best trial: 5. Best value: 0.963755:  80%|████████  | 12/15 [01:48<00:21,  7.01s/it]Best trial: 5. Best value: 0.963755:  87%|████████▋ | 13/15 [01:48<00:12,  6.37s/it]                                                                                    Best trial: 5. Best value: 0.963755:  87%|████████▋ | 13/15 [01:52<00:12,  6.37s/it]Best trial: 5. Best value: 0.963755:  87%|████████▋ | 13/15 [01:52<00:12,  6.37s/it]Best trial: 5. Best value: 0.963755:  93%|█████████▎| 14/15 [01:52<00:05,  5.72s/it]                                                                                    Best trial: 5. Best value: 0.963755:  93%|█████████▎| 14/15 [01:56<00:05,  5.72s/it]Best trial: 5. Best value: 0.963755:  93%|█████████▎| 14/15 [01:56<00:05,  5.72s/it]Best trial: 5. Best value: 0.963755: 100%|██████████| 15/15 [01:56<00:00,  5.33s/it]Best trial: 5. Best value: 0.963755: 100%|██████████| 15/15 [01:56<00:00,  7.78s/it]
2025-11-22 16:18:19,698 - INFO - Best CatBoost params: {'iterations': 694, 'learning_rate': 0.043499731085456995, 'depth': 6, 'l2_leaf_reg': 2.939743293404463, 'bagging_temperature': 0.009914209394570328, 'random_strength': 6.699859604441512}
2025-11-22 16:18:19,699 - INFO - Best CV AUC: 0.9638
2025-11-22 16:18:23,955 - INFO - Final CatBoost model trained.
2025-11-22 16:18:23,955 - INFO - Training LightGBM model...
2025-11-22 16:18:23,965 - INFO - Optimizing LightGBM hyperparameters (15 trials)...
[I 2025-11-22 16:18:23,969] A new study created in memory with name: lightgbm_optimization
[I 2025-11-22 16:16:31,923] Trial 0 finished with value: 0.9409187063511896 and parameters: {'iterations': 987, 'learning_rate': 0.010662231467414029, 'depth': 7, 'l2_leaf_reg': 9.848203830133887, 'bagging_temperature': 0.9042780356436949, 'random_strength': 6.071166214271718}. Best is trial 0 with value: 0.9409187063511896.
[I 2025-11-22 16:16:41,764] Trial 1 finished with value: 0.9562169715781306 and parameters: {'iterations': 1438, 'learning_rate': 0.055918390838960205, 'depth': 5, 'l2_leaf_reg': 5.6527063373676185, 'bagging_temperature': 0.6866288598445085, 'random_strength': 9.221770129897912}. Best is trial 1 with value: 0.9562169715781306.
[I 2025-11-22 16:16:49,092] Trial 2 finished with value: 0.9411119513895282 and parameters: {'iterations': 918, 'learning_rate': 0.01138920498809905, 'depth': 6, 'l2_leaf_reg': 9.08451228506666, 'bagging_temperature': 0.6250489053485886, 'random_strength': 3.30861207612952}. Best is trial 1 with value: 0.9562169715781306.
[I 2025-11-22 16:17:06,380] Trial 3 finished with value: 0.9444500019728275 and parameters: {'iterations': 1314, 'learning_rate': 0.03278009222161037, 'depth': 8, 'l2_leaf_reg': 8.2279666397238, 'bagging_temperature': 0.08778469131437205, 'random_strength': 5.728665622918019}. Best is trial 1 with value: 0.9562169715781306.
[I 2025-11-22 16:17:12,220] Trial 4 finished with value: 0.9548436336853735 and parameters: {'iterations': 635, 'learning_rate': 0.021817139839690247, 'depth': 6, 'l2_leaf_reg': 4.628398193545306, 'bagging_temperature': 0.6078839933046569, 'random_strength': 6.37032143449103}. Best is trial 1 with value: 0.9562169715781306.
[I 2025-11-22 16:17:17,839] Trial 5 finished with value: 0.9637545802480502 and parameters: {'iterations': 694, 'learning_rate': 0.043499731085456995, 'depth': 6, 'l2_leaf_reg': 2.939743293404463, 'bagging_temperature': 0.009914209394570328, 'random_strength': 6.699859604441512}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:17:24,391] Trial 6 finished with value: 0.9632711980324333 and parameters: {'iterations': 945, 'learning_rate': 0.07055273933445717, 'depth': 5, 'l2_leaf_reg': 6.725543348806996, 'bagging_temperature': 0.5562900138014436, 'random_strength': 9.659463626437182}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:17:33,475] Trial 7 finished with value: 0.9339075532992254 and parameters: {'iterations': 1136, 'learning_rate': 0.05144631049823625, 'depth': 6, 'l2_leaf_reg': 9.643112869029517, 'bagging_temperature': 0.27467170713220557, 'random_strength': 2.515946629334854}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:17:45,690] Trial 8 finished with value: 0.94359551773572 and parameters: {'iterations': 906, 'learning_rate': 0.014016141219123696, 'depth': 8, 'l2_leaf_reg': 8.798758066055443, 'bagging_temperature': 0.20216228966151495, 'random_strength': 8.576660333047808}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:17:59,754] Trial 9 finished with value: 0.9575147896308183 and parameters: {'iterations': 1022, 'learning_rate': 0.018225175496120023, 'depth': 8, 'l2_leaf_reg': 1.3127823850390081, 'bagging_temperature': 0.45286365104085624, 'random_strength': 5.914502771048365}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:18:01,813] Trial 10 finished with value: 0.9443929872555337 and parameters: {'iterations': 334, 'learning_rate': 0.09643426798994652, 'depth': 4, 'l2_leaf_reg': 2.3007827706712836, 'bagging_temperature': 0.04160970622176257, 'random_strength': 0.7722791214157496}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:18:06,171] Trial 11 finished with value: 0.9576775610590138 and parameters: {'iterations': 651, 'learning_rate': 0.06976536507035845, 'depth': 5, 'l2_leaf_reg': 5.962873301528017, 'bagging_temperature': 0.39610779500912385, 'random_strength': 7.926624994571637}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:18:11,078] Trial 12 finished with value: 0.9635716333697211 and parameters: {'iterations': 693, 'learning_rate': 0.03677303908361425, 'depth': 5, 'l2_leaf_reg': 3.7011950390604826, 'bagging_temperature': 0.8551549147972901, 'random_strength': 7.548238913245276}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:18:15,287] Trial 13 finished with value: 0.9558994910104823 and parameters: {'iterations': 619, 'learning_rate': 0.033585692290131176, 'depth': 4, 'l2_leaf_reg': 3.514969788454938, 'bagging_temperature': 0.8791943258443997, 'random_strength': 7.584233446884379}. Best is trial 5 with value: 0.9637545802480502.
[I 2025-11-22 16:18:19,698] Trial 14 finished with value: 0.9507136243473229 and parameters: {'iterations': 429, 'learning_rate': 0.04280095074954769, 'depth': 7, 'l2_leaf_reg': 3.4347255164425254, 'bagging_temperature': 0.7756295450999833, 'random_strength': 4.213907565405144}. Best is trial 5 with value: 0.9637545802480502.
0:	total: 8.53ms	remaining: 5.91s
100:	total: 611ms	remaining: 3.59s
200:	total: 1.2s	remaining: 2.95s
300:	total: 1.81s	remaining: 2.36s
400:	total: 2.41s	remaining: 1.76s
500:	total: 3.04s	remaining: 1.17s
600:	total: 3.65s	remaining: 565ms
693:	total: 4.23s	remaining: 0us
  0%|          | 0/15 [00:00<?, ?it/s]                                        0%|          | 0/15 [00:02<?, ?it/s]Best trial: 0. Best value: 0.962372:   0%|          | 0/15 [00:02<?, ?it/s]Best trial: 0. Best value: 0.962372:   7%|▋         | 1/15 [00:02<00:40,  2.87s/it]                                                                                   Best trial: 0. Best value: 0.962372:   7%|▋         | 1/15 [00:04<00:40,  2.87s/it]Best trial: 0. Best value: 0.962372:   7%|▋         | 1/15 [00:04<00:40,  2.87s/it]Best trial: 0. Best value: 0.962372:  13%|█▎        | 2/15 [00:04<00:28,  2.18s/it]                                                                                   Best trial: 0. Best value: 0.962372:  13%|█▎        | 2/15 [00:05<00:28,  2.18s/it]Best trial: 2. Best value: 0.971313:  13%|█▎        | 2/15 [00:05<00:28,  2.18s/it]Best trial: 2. Best value: 0.971313:  20%|██        | 3/15 [00:05<00:19,  1.65s/it]                                                                                   Best trial: 2. Best value: 0.971313:  20%|██        | 3/15 [00:09<00:19,  1.65s/it]Best trial: 2. Best value: 0.971313:  20%|██        | 3/15 [00:09<00:19,  1.65s/it]Best trial: 2. Best value: 0.971313:  27%|██▋       | 4/15 [00:09<00:26,  2.38s/it]                                                                                   Best trial: 2. Best value: 0.971313:  27%|██▋       | 4/15 [00:10<00:26,  2.38s/it]Best trial: 2. Best value: 0.971313:  27%|██▋       | 4/15 [00:10<00:26,  2.38s/it]Best trial: 2. Best value: 0.971313:  33%|███▎      | 5/15 [00:10<00:21,  2.12s/it]                                                                                   Best trial: 2. Best value: 0.971313:  33%|███▎      | 5/15 [00:14<00:21,  2.12s/it]Best trial: 2. Best value: 0.971313:  33%|███▎      | 5/15 [00:14<00:21,  2.12s/it]Best trial: 2. Best value: 0.971313:  40%|████      | 6/15 [00:14<00:22,  2.54s/it]                                                                                   Best trial: 2. Best value: 0.971313:  40%|████      | 6/15 [00:18<00:22,  2.54s/it]Best trial: 2. Best value: 0.971313:  40%|████      | 6/15 [00:18<00:22,  2.54s/it]Best trial: 2. Best value: 0.971313:  47%|████▋     | 7/15 [00:18<00:24,  3.04s/it]                                                                                   Best trial: 2. Best value: 0.971313:  47%|████▋     | 7/15 [00:19<00:24,  3.04s/it]Best trial: 2. Best value: 0.971313:  47%|████▋     | 7/15 [00:19<00:24,  3.04s/it]Best trial: 2. Best value: 0.971313:  53%|█████▎    | 8/15 [00:19<00:18,  2.64s/it]                                                                                   Best trial: 2. Best value: 0.971313:  53%|█████▎    | 8/15 [00:22<00:18,  2.64s/it]Best trial: 2. Best value: 0.971313:  53%|█████▎    | 8/15 [00:22<00:18,  2.64s/it]Best trial: 2. Best value: 0.971313:  60%|██████    | 9/15 [00:22<00:16,  2.68s/it]                                                                                   Best trial: 2. Best value: 0.971313:  60%|██████    | 9/15 [00:24<00:16,  2.68s/it]Best trial: 2. Best value: 0.971313:  60%|██████    | 9/15 [00:24<00:16,  2.68s/it]Best trial: 2. Best value: 0.971313:  67%|██████▋   | 10/15 [00:24<00:11,  2.37s/it]                                                                                    Best trial: 2. Best value: 0.971313:  67%|██████▋   | 10/15 [00:25<00:11,  2.37s/it]Best trial: 2. Best value: 0.971313:  67%|██████▋   | 10/15 [00:25<00:11,  2.37s/it]Best trial: 2. Best value: 0.971313:  73%|███████▎  | 11/15 [00:25<00:07,  1.94s/it]                                                                                    Best trial: 2. Best value: 0.971313:  73%|███████▎  | 11/15 [00:26<00:07,  1.94s/it]Best trial: 2. Best value: 0.971313:  73%|███████▎  | 11/15 [00:26<00:07,  1.94s/it]Best trial: 2. Best value: 0.971313:  80%|████████  | 12/15 [00:26<00:05,  1.71s/it]                                                                                    Best trial: 2. Best value: 0.971313:  80%|████████  | 12/15 [00:27<00:05,  1.71s/it]Best trial: 2. Best value: 0.971313:  80%|████████  | 12/15 [00:27<00:05,  1.71s/it]Best trial: 2. Best value: 0.971313:  87%|████████▋ | 13/15 [00:27<00:02,  1.47s/it]                                                                                    Best trial: 2. Best value: 0.971313:  87%|████████▋ | 13/15 [00:33<00:02,  1.47s/it]Best trial: 2. Best value: 0.971313:  87%|████████▋ | 13/15 [00:33<00:02,  1.47s/it]Best trial: 2. Best value: 0.971313:  93%|█████████▎| 14/15 [00:33<00:02,  2.70s/it]                                                                                    Best trial: 2. Best value: 0.971313:  93%|█████████▎| 14/15 [00:35<00:02,  2.70s/it]Best trial: 2. Best value: 0.971313:  93%|█████████▎| 14/15 [00:35<00:02,  2.70s/it]Best trial: 2. Best value: 0.971313: 100%|██████████| 15/15 [00:35<00:00,  2.50s/it]Best trial: 2. Best value: 0.971313: 100%|██████████| 15/15 [00:35<00:00,  2.34s/it]
2025-11-22 16:18:59,000 - INFO - Best LightGBM params: {'n_estimators': 304, 'learning_rate': 0.01666027499289402, 'num_leaves': 43, 'max_depth': 9, 'reg_alpha': 0.05967956363498839, 'reg_lambda': 5.212157976257169, 'subsample': 0.6777831853115934, 'colsample_bytree': 0.6395993710520664}
2025-11-22 16:19:00,358 - INFO - LightGBM model trained.
2025-11-22 16:19:00,359 - INFO - Training XGBoost model...
2025-11-22 16:19:00,393 - INFO - Optimizing XGBoost hyperparameters (15 trials)...
[I 2025-11-22 16:19:00,397] A new study created in memory with name: xgboost_optimization
[I 2025-11-22 16:18:26,838] Trial 0 finished with value: 0.9623719832178133 and parameters: {'n_estimators': 1147, 'learning_rate': 0.022558648020303898, 'num_leaves': 53, 'max_depth': 8, 'reg_alpha': 0.03519848764639068, 'reg_lambda': 0.009251298684637073, 'subsample': 0.8278973057037797, 'colsample_bytree': 0.7447938736311935}. Best is trial 0 with value: 0.9623719832178133.
[I 2025-11-22 16:18:28,530] Trial 1 finished with value: 0.9579849736298712 and parameters: {'n_estimators': 997, 'learning_rate': 0.043754852658594065, 'num_leaves': 54, 'max_depth': 10, 'reg_alpha': 1.5253091431814574, 'reg_lambda': 0.14397301869471452, 'subsample': 0.5700437836720458, 'colsample_bytree': 0.8813549589448835}. Best is trial 0 with value: 0.9623719832178133.
[I 2025-11-22 16:18:29,560] Trial 2 finished with value: 0.9713131469230466 and parameters: {'n_estimators': 304, 'learning_rate': 0.01666027499289402, 'num_leaves': 43, 'max_depth': 9, 'reg_alpha': 0.05967956363498839, 'reg_lambda': 5.212157976257169, 'subsample': 0.6777831853115934, 'colsample_bytree': 0.6395993710520664}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:33,043] Trial 3 finished with value: 0.9604678363342233 and parameters: {'n_estimators': 1352, 'learning_rate': 0.017000791349819463, 'num_leaves': 60, 'max_depth': 10, 'reg_alpha': 0.10935340393500846, 'reg_lambda': 0.12837497691777616, 'subsample': 0.610555536731108, 'colsample_bytree': 0.5977663457054767}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:34,701] Trial 4 finished with value: 0.9603810121920744 and parameters: {'n_estimators': 668, 'learning_rate': 0.03277333593488077, 'num_leaves': 44, 'max_depth': 6, 'reg_alpha': 0.1194289526997001, 'reg_lambda': 0.007885003284024332, 'subsample': 0.8234158747087663, 'colsample_bytree': 0.8258573344619744}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:38,062] Trial 5 finished with value: 0.9675277708363474 and parameters: {'n_estimators': 865, 'learning_rate': 0.010225822850082673, 'num_leaves': 71, 'max_depth': 9, 'reg_alpha': 0.0015922312338822041, 'reg_lambda': 0.07105940636112879, 'subsample': 0.9063679951481319, 'colsample_bytree': 0.8421970696727331}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:42,124] Trial 6 finished with value: 0.9665777622874279 and parameters: {'n_estimators': 1024, 'learning_rate': 0.010678176171831285, 'num_leaves': 36, 'max_depth': 10, 'reg_alpha': 0.015984793973362877, 'reg_lambda': 0.028678761536653108, 'subsample': 0.7572292237945805, 'colsample_bytree': 0.5074657998417502}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:43,905] Trial 7 finished with value: 0.9624190022753278 and parameters: {'n_estimators': 713, 'learning_rate': 0.012130075105564728, 'num_leaves': 81, 'max_depth': 9, 'reg_alpha': 0.929557500865094, 'reg_lambda': 0.0018423408270696355, 'subsample': 0.7243325574121675, 'colsample_bytree': 0.7660511576269768}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:46,669] Trial 8 finished with value: 0.9653936317125459 and parameters: {'n_estimators': 992, 'learning_rate': 0.0147355960773337, 'num_leaves': 53, 'max_depth': 4, 'reg_alpha': 1.160714172184097, 'reg_lambda': 6.854589755485684, 'subsample': 0.8009218596069463, 'colsample_bytree': 0.6727479836990171}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:48,362] Trial 9 finished with value: 0.9582705733036971 and parameters: {'n_estimators': 1060, 'learning_rate': 0.03592772689409652, 'num_leaves': 30, 'max_depth': 5, 'reg_alpha': 1.9158583614023177, 'reg_lambda': 0.038243438483664814, 'subsample': 0.5638678219830784, 'colsample_bytree': 0.6746126817707208}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:49,328] Trial 10 finished with value: 0.9575945773545698 and parameters: {'n_estimators': 313, 'learning_rate': 0.0846901237528376, 'num_leaves': 20, 'max_depth': 7, 'reg_alpha': 0.002848338620234447, 'reg_lambda': 9.032164338687798, 'subsample': 0.6636653657313325, 'colsample_bytree': 0.9655528806335506}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:50,516] Trial 11 finished with value: 0.9669317335893625 and parameters: {'n_estimators': 324, 'learning_rate': 0.021463718204525323, 'num_leaves': 82, 'max_depth': 8, 'reg_alpha': 0.001339357493342073, 'reg_lambda': 1.270220205150221, 'subsample': 0.9734522509685145, 'colsample_bytree': 0.9021921357924964}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:51,412] Trial 12 finished with value: 0.7271352833638026 and parameters: {'n_estimators': 571, 'learning_rate': 0.010127231341062928, 'num_leaves': 98, 'max_depth': 8, 'reg_alpha': 9.30664597500491, 'reg_lambda': 0.7267805989510492, 'subsample': 0.9498862252970942, 'colsample_bytree': 0.5673830086771299}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:56,970] Trial 13 finished with value: 0.9539157734141754 and parameters: {'n_estimators': 1489, 'learning_rate': 0.020171648329270323, 'num_leaves': 74, 'max_depth': 9, 'reg_alpha': 0.008087572788236158, 'reg_lambda': 0.6608645260162054, 'subsample': 0.9099371335949701, 'colsample_bytree': 0.7182972144871906}. Best is trial 2 with value: 0.9713131469230466.
[I 2025-11-22 16:18:58,999] Trial 14 finished with value: 0.9690377862244026 and parameters: {'n_estimators': 508, 'learning_rate': 0.014643254657745979, 'num_leaves': 69, 'max_depth': 9, 'reg_alpha': 0.001022567025553623, 'reg_lambda': 2.1499786197625106, 'subsample': 0.5008204834052191, 'colsample_bytree': 0.8148110426294647}. Best is trial 2 with value: 0.9713131469230466.
  0%|          | 0/15 [00:00<?, ?it/s]                                        0%|          | 0/15 [00:01<?, ?it/s]Best trial: 0. Best value: 0.970774:   0%|          | 0/15 [00:01<?, ?it/s]Best trial: 0. Best value: 0.970774:   7%|▋         | 1/15 [00:01<00:17,  1.26s/it]                                                                                   Best trial: 0. Best value: 0.970774:   7%|▋         | 1/15 [00:02<00:17,  1.26s/it]Best trial: 0. Best value: 0.970774:   7%|▋         | 1/15 [00:02<00:17,  1.26s/it]Best trial: 0. Best value: 0.970774:  13%|█▎        | 2/15 [00:02<00:13,  1.07s/it]                                                                                   Best trial: 0. Best value: 0.970774:  13%|█▎        | 2/15 [00:02<00:13,  1.07s/it]Best trial: 0. Best value: 0.970774:  13%|█▎        | 2/15 [00:02<00:13,  1.07s/it]Best trial: 0. Best value: 0.970774:  20%|██        | 3/15 [00:02<00:11,  1.06it/s]                                                                                   Best trial: 0. Best value: 0.970774:  20%|██        | 3/15 [00:03<00:11,  1.06it/s]Best trial: 3. Best value: 0.97319:  20%|██        | 3/15 [00:03<00:11,  1.06it/s] Best trial: 3. Best value: 0.97319:  27%|██▋       | 4/15 [00:03<00:08,  1.24it/s]                                                                                  Best trial: 3. Best value: 0.97319:  27%|██▋       | 4/15 [00:04<00:08,  1.24it/s]Best trial: 3. Best value: 0.97319:  27%|██▋       | 4/15 [00:04<00:08,  1.24it/s]Best trial: 3. Best value: 0.97319:  33%|███▎      | 5/15 [00:04<00:09,  1.03it/s]                                                                                  Best trial: 3. Best value: 0.97319:  33%|███▎      | 5/15 [00:06<00:09,  1.03it/s]Best trial: 3. Best value: 0.97319:  33%|███▎      | 5/15 [00:06<00:09,  1.03it/s]Best trial: 3. Best value: 0.97319:  40%|████      | 6/15 [00:06<00:10,  1.19s/it]                                                                                  Best trial: 3. Best value: 0.97319:  40%|████      | 6/15 [00:07<00:10,  1.19s/it]Best trial: 3. Best value: 0.97319:  40%|████      | 6/15 [00:07<00:10,  1.19s/it]Best trial: 3. Best value: 0.97319:  47%|████▋     | 7/15 [00:07<00:09,  1.25s/it]                                                                                  Best trial: 3. Best value: 0.97319:  47%|████▋     | 7/15 [00:09<00:09,  1.25s/it]Best trial: 3. Best value: 0.97319:  47%|████▋     | 7/15 [00:09<00:09,  1.25s/it]Best trial: 3. Best value: 0.97319:  53%|█████▎    | 8/15 [00:09<00:08,  1.28s/it]                                                                                  Best trial: 3. Best value: 0.97319:  53%|█████▎    | 8/15 [00:10<00:08,  1.28s/it]Best trial: 3. Best value: 0.97319:  53%|█████▎    | 8/15 [00:10<00:08,  1.28s/it]Best trial: 3. Best value: 0.97319:  60%|██████    | 9/15 [00:10<00:06,  1.15s/it]                                                                                  Best trial: 3. Best value: 0.97319:  60%|██████    | 9/15 [00:11<00:06,  1.15s/it]Best trial: 3. Best value: 0.97319:  60%|██████    | 9/15 [00:11<00:06,  1.15s/it]Best trial: 3. Best value: 0.97319:  67%|██████▋   | 10/15 [00:11<00:06,  1.31s/it]                                                                                   Best trial: 3. Best value: 0.97319:  67%|██████▋   | 10/15 [00:13<00:06,  1.31s/it]Best trial: 3. Best value: 0.97319:  67%|██████▋   | 10/15 [00:13<00:06,  1.31s/it]Best trial: 3. Best value: 0.97319:  73%|███████▎  | 11/15 [00:13<00:06,  1.51s/it]                                                                                   Best trial: 3. Best value: 0.97319:  73%|███████▎  | 11/15 [00:14<00:06,  1.51s/it]Best trial: 11. Best value: 0.973248:  73%|███████▎  | 11/15 [00:14<00:06,  1.51s/it]Best trial: 11. Best value: 0.973248:  80%|████████  | 12/15 [00:14<00:03,  1.22s/it]                                                                                     Best trial: 11. Best value: 0.973248:  80%|████████  | 12/15 [00:14<00:03,  1.22s/it]Best trial: 11. Best value: 0.973248:  80%|████████  | 12/15 [00:14<00:03,  1.22s/it]Best trial: 11. Best value: 0.973248:  87%|████████▋ | 13/15 [00:14<00:01,  1.00it/s]                                                                                     Best trial: 11. Best value: 0.973248:  87%|████████▋ | 13/15 [00:15<00:01,  1.00it/s]Best trial: 11. Best value: 0.973248:  87%|████████▋ | 13/15 [00:15<00:01,  1.00it/s]Best trial: 11. Best value: 0.973248:  93%|█████████▎| 14/15 [00:15<00:00,  1.06it/s]                                                                                     Best trial: 11. Best value: 0.973248:  93%|█████████▎| 14/15 [00:16<00:00,  1.06it/s]Best trial: 11. Best value: 0.973248:  93%|█████████▎| 14/15 [00:16<00:00,  1.06it/s]Best trial: 11. Best value: 0.973248: 100%|██████████| 15/15 [00:16<00:00,  1.04s/it]Best trial: 11. Best value: 0.973248: 100%|██████████| 15/15 [00:16<00:00,  1.12s/it]
2025-11-22 16:19:17,187 - INFO - Best XGBoost params: {'n_estimators': 348, 'learning_rate': 0.06731937824643393, 'max_depth': 8, 'reg_alpha': 0.6840432872335936, 'reg_lambda': 0.48269985508612273, 'subsample': 0.6607936088398498, 'colsample_bytree': 0.5297416738740447, 'gamma': 2.3346756222474947}
2025-11-22 16:19:17,415 - INFO - XGBoost model trained.
2025-11-22 16:19:17,415 - INFO - Training Stacking Ensemble (3 base models)...
2025-11-22 16:19:17,417 - INFO - Generating out-of-fold predictions...
2025-11-22 16:19:24,959 - INFO - Stacking Meta-Model Coefficients: [[2.04623468 0.53674091 3.37348449]]
2025-11-22 16:19:24,960 - INFO - Saving models to models/...
2025-11-22 16:19:24,968 - INFO - Models saved successfully.
2025-11-22 16:19:24,968 - INFO - Generating SHAP explanations...
2025-11-22 16:19:24,975 - INFO - Generating SHAP explanation...
2025-11-22 16:19:25,666 - INFO - SHAP summary saved to shap_summary.png
2025-11-22 16:19:25,666 - INFO - 
============================================================
2025-11-22 16:19:25,666 - INFO - TRAIN SET METRICS (reference only):
2025-11-22 16:19:25,666 - INFO - ============================================================
2025-11-22 16:19:25,669 - INFO - Calculating business metrics...
2025-11-22 16:19:25,713 - INFO - Saved Money: 10,800,000.00
2025-11-22 16:19:25,713 - INFO - Lost Money: 10,248,997.37
2025-11-22 16:19:25,713 - INFO - Blocked Legit Money: 0.00
2025-11-22 16:19:25,713 - INFO - 
============================================================
2025-11-22 16:19:25,713 - INFO - HOLDOUT TEST SET METRICS (final evaluation):
2025-11-22 16:19:25,713 - INFO - ============================================================
2025-11-22 16:19:25,716 - INFO - Calculating business metrics...
2025-11-22 16:19:25,731 - INFO - Saved Money: 0.00
2025-11-22 16:19:25,731 - INFO - Lost Money: 16,018,157.00
2025-11-22 16:19:25,731 - INFO - Blocked Legit Money: 0.00
2025-11-22 16:19:25,731 - INFO - 
============================================================
2025-11-22 16:19:25,731 - INFO - SUMMARY:
2025-11-22 16:19:25,731 - INFO - ============================================================
2025-11-22 16:19:25,731 - INFO - Train Set Saved: 10,800,000.00 KZT
2025-11-22 16:19:25,731 - INFO - Holdout Set Saved: 0.00 KZT
2025-11-22 16:19:25,731 - INFO - Holdout Set Lost: 16,018,157.00 KZT
2025-11-22 16:19:25,731 - INFO - ============================================================

[I 2025-11-22 16:19:01,661] Trial 0 finished with value: 0.9707736772191022 and parameters: {'n_estimators': 717, 'learning_rate': 0.01725868964397425, 'max_depth': 10, 'reg_alpha': 0.017565677337483685, 'reg_lambda': 1.1743496157998863, 'subsample': 0.764552439872604, 'colsample_bytree': 0.708442677827066, 'gamma': 0.14975595309072942}. Best is trial 0 with value: 0.9707736772191022.
[I 2025-11-22 16:19:02,590] Trial 1 finished with value: 0.9692083963542146 and parameters: {'n_estimators': 369, 'learning_rate': 0.026535473008017313, 'max_depth': 5, 'reg_alpha': 2.840173914939879, 'reg_lambda': 0.0011636666292824816, 'subsample': 0.5310934731944486, 'colsample_bytree': 0.8214529585289417, 'gamma': 1.2831288627654425}. Best is trial 0 with value: 0.9707736772191022.
[I 2025-11-22 16:19:03,385] Trial 2 finished with value: 0.9662728749358831 and parameters: {'n_estimators': 613, 'learning_rate': 0.04988183624317119, 'max_depth': 7, 'reg_alpha': 0.10249834497711863, 'reg_lambda': 0.0026917423716277616, 'subsample': 0.922275539509575, 'colsample_bytree': 0.6119674245210159, 'gamma': 4.943796177401709}. Best is trial 0 with value: 0.9707736772191022.
[I 2025-11-22 16:19:03,981] Trial 3 finished with value: 0.9731900490576461 and parameters: {'n_estimators': 338, 'learning_rate': 0.024468569477510207, 'max_depth': 10, 'reg_alpha': 0.2890804612177351, 'reg_lambda': 1.9978371785566122, 'subsample': 0.5834839179156193, 'colsample_bytree': 0.6442069348687942, 'gamma': 0.4106980050458925}. Best is trial 3 with value: 0.9731900490576461.
[I 2025-11-22 16:19:05,243] Trial 4 finished with value: 0.7258135283363802 and parameters: {'n_estimators': 971, 'learning_rate': 0.010282239710212169, 'max_depth': 6, 'reg_alpha': 6.71706977511538, 'reg_lambda': 0.0024930634714286585, 'subsample': 0.674364385330122, 'colsample_bytree': 0.6292530026423044, 'gamma': 1.7490485100835036}. Best is trial 3 with value: 0.9731900490576461.
[I 2025-11-22 16:19:06,847] Trial 5 finished with value: 0.9707740191758841 and parameters: {'n_estimators': 1135, 'learning_rate': 0.03310530666515398, 'max_depth': 9, 'reg_alpha': 0.005227380089207355, 'reg_lambda': 0.04962665896062775, 'subsample': 0.9593303391323279, 'colsample_bytree': 0.7533368535716134, 'gamma': 0.6653527478386562}. Best is trial 3 with value: 0.9731900490576461.
[I 2025-11-22 16:19:08,216] Trial 6 finished with value: 0.7109213893967093 and parameters: {'n_estimators': 1112, 'learning_rate': 0.033192716505529095, 'max_depth': 9, 'reg_alpha': 8.229164460985176, 'reg_lambda': 0.01851684403364389, 'subsample': 0.8334557397649308, 'colsample_bytree': 0.8492773958112193, 'gamma': 3.019036408269902}. Best is trial 3 with value: 0.9731900490576461.
[I 2025-11-22 16:19:09,561] Trial 7 finished with value: 0.972649053700367 and parameters: {'n_estimators': 1056, 'learning_rate': 0.03580928641749381, 'max_depth': 8, 'reg_alpha': 2.6568289759257944, 'reg_lambda': 1.1164744663404271, 'subsample': 0.8063937121711138, 'colsample_bytree': 0.5721800517211051, 'gamma': 2.55118918621699}. Best is trial 3 with value: 0.9731900490576461.
[I 2025-11-22 16:19:10,416] Trial 8 finished with value: 0.971424736627517 and parameters: {'n_estimators': 569, 'learning_rate': 0.023701708967336362, 'max_depth': 5, 'reg_alpha': 0.06976718193535826, 'reg_lambda': 1.3773567442428143, 'subsample': 0.9120862142778152, 'colsample_bytree': 0.5862858195716616, 'gamma': 4.353423149223522}. Best is trial 3 with value: 0.9731900490576461.
[I 2025-11-22 16:19:12,103] Trial 9 finished with value: 0.9651474359817448 and parameters: {'n_estimators': 1115, 'learning_rate': 0.03547906141828723, 'max_depth': 10, 'reg_alpha': 3.6676821376107887, 'reg_lambda': 0.016591052386914776, 'subsample': 0.6641996519018298, 'colsample_bytree': 0.723550784658853, 'gamma': 4.751405639212564}. Best is trial 3 with value: 0.9731900490576461.
[I 2025-11-22 16:19:14,050] Trial 10 finished with value: 0.7286800731261426 and parameters: {'n_estimators': 1436, 'learning_rate': 0.09104668186355126, 'max_depth': 4, 'reg_alpha': 0.3583211820336294, 'reg_lambda': 8.069168032927374, 'subsample': 0.5249588489188167, 'colsample_bytree': 0.9419381569456067, 'gamma': 3.5885003152467823}. Best is trial 3 with value: 0.9731900490576461.
[I 2025-11-22 16:19:14,600] Trial 11 finished with value: 0.9732482869280443 and parameters: {'n_estimators': 348, 'learning_rate': 0.06731937824643393, 'max_depth': 8, 'reg_alpha': 0.6840432872335936, 'reg_lambda': 0.48269985508612273, 'subsample': 0.6607936088398498, 'colsample_bytree': 0.5297416738740447, 'gamma': 2.3346756222474947}. Best is trial 11 with value: 0.9732482869280443.
[I 2025-11-22 16:19:15,101] Trial 12 finished with value: 0.9725045572317284 and parameters: {'n_estimators': 314, 'learning_rate': 0.0732163509303866, 'max_depth': 8, 'reg_alpha': 0.6269151401969821, 'reg_lambda': 0.4649415532429118, 'subsample': 0.646860169731697, 'colsample_bytree': 0.5093063846506038, 'gamma': 1.7637830824921796}. Best is trial 11 with value: 0.9732482869280443.
[I 2025-11-22 16:19:15,912] Trial 13 finished with value: 0.9723104441492509 and parameters: {'n_estimators': 469, 'learning_rate': 0.05328749299480518, 'max_depth': 8, 'reg_alpha': 0.6058253526811751, 'reg_lambda': 9.690178706176015, 'subsample': 0.5998912815129982, 'colsample_bytree': 0.5013572821495587, 'gamma': 0.042705709546837944}. Best is trial 11 with value: 0.9732482869280443.
[I 2025-11-22 16:19:17,186] Trial 14 finished with value: 0.9708727789249405 and parameters: {'n_estimators': 789, 'learning_rate': 0.01694516006732062, 'max_depth': 9, 'reg_alpha': 0.12309832459493404, 'reg_lambda': 0.22368373262218438, 'subsample': 0.5835743264042829, 'colsample_bytree': 0.6729379913088018, 'gamma': 1.2281113730310964}. Best is trial 11 with value: 0.9732482869280443.
