

# **Стратегическая дорожная карта разработки AI-системы обнаружения мошеннических транзакций: Архитектура мультиагентных систем для ForteBank AI Hackathon**

## **Аннотация**

В настоящем аналитическом отчете представлена исчерпывающая стратегия решения Задачи №1 (Transactional Fraud Detection) в рамках AI-хакатона ForteBank. Документ разработан для команды AI-агентов и технических специалистов с целью создания высокоточного алгоритмического решения, способного выявлять аномальные паттерны в финансовых транзакциях. Основываясь на предоставленных наборах данных — поведенческой биометрии (поведенческие\_паттерны\_клиентов\_3.csv) 1 и транзакционных логах (транзакции\_в\_Мобильном\_интернет\_Банкинге.csv) 1, а также методологии хакатона 1, — предлагается архитектура, выходящая за рамки классического обучения с учителем. Анализ показывает, что ключевым фактором успеха является интеграция «цифрового отпечатка» (Device Fingerprinting) с графовым анализом связей и глубокой поведенческой аналитикой (Behavioral Biometrics). В отчете детально описываются роли AI-агентов, спецификации для инжиниринга признаков (Feature Engineering), стратегии валидации временных рядов и методы борьбы с концептуальным дрейфом данных (Concept Drift). Особое внимание уделено интерпретируемости моделей в соответствии с критериями юзабилити ForteBank.

---

## **Глава 1\. Фундаментальный анализ предметной области и постановка задачи**

Проблема обнаружения мошенничества (Fraud Detection) в современном цифровом банкинге представляет собой классическую задачу поиска аномалий в условиях жесткого дисбаланса классов и постоянно эволюционирующих векторов атак. Хакатон ForteBank ставит задачу разработки инновационного AI-решения, что требует не просто применения стандартных алгоритмов, но глубокого понимания природы данных.

### **1.1. Экосистема данных: Дихотомия «Цифрового Я» и «Экономического Я»**

Предоставленные данные позволяют реконструировать два параллельных профиля клиента: его поведенческий портрет («Цифровое Я») и финансовую активность («Экономическое Я»). Успешная модель должна функционировать на стыке этих двух пространств, выявляя диссонанс между ними.

#### **1.1.1. Поведенческая биометрия как первичный фильтр**

Набор данных поведенческие\_паттерны\_клиентов\_3.csv 1 предоставляет уникальные метрики, характеризующие взаимодействие пользователя с устройством. В отличие от транзакционных данных, которые фиксируют *результат* действия, поведенческие данные фиксируют *процесс* и *намерение*. Мошенничество часто проявляется как нарушение привычной инерции поведения (Behavioral Inertia) еще до того, как средства будут списаны.

Анализ полей monthly\_os\_changes и monthly\_phone\_model\_changes выявляет критические индикаторы использования эмуляторов или «ферм устройств» (Device Farms). Легитимные пользователи крайне редко меняют операционную систему или модель телефона чаще одного раза в месяц. Значения, превышающие единицу, служат сильным сигналом компрометации или использования специализированного ПО для спуфинга (например, Genymotion или Multilogin).

Таблица 1\. Анализ аномалий в смене устройств и ОС 1

| transdate | cst\_dim\_id | monthly\_os\_changes | monthly\_phone\_model\_changes | last\_phone\_model | Интерпретация риска |
| :---- | :---- | :---- | :---- | :---- | :---- |
| 2025-05-19 | 452718092 | 29 | 4 | Xiaomi\_poco\_f2\_pro | **Критический.** 29 смен ОС за месяц на 4 моделях указывают на автоматизированный скрипт ротации User-Agent или эмулятор Android. |
| 2025-03-05 | 453024373 | 2 | 2 | Vivo V2116 | **Высокий.** Частая смена идентичности устройства характерна для попыток обхода антифрод-систем. |
| 2025-01-02 | 452718092 | 69 | 160 | implyForteApp... | **Экстремальный.** 160 смен модели телефона — явный признак брутфорс-атаки или массовой регистрации аккаунтов (дропов). |

Как видно из Таблицы 1, данные содержат явные следы синтетической активности. Особенно показателен пример пользователя 452718092 1, который демонстрирует патологическую частоту смены цифровых отпечатков. Это требует от AI-агентов создания признаков, фиксирующих не просто факт смены устройства, а *скорость* и *траекторию* этих изменений.

#### **1.1.2. Статистическая физика входов в систему**

Набор данных 1 вводит сложные метрики временной структуры сессий: burstiness\_login\_interval (коэффициент взрывности) и fano\_factor\_login\_interval (фактор Фано). Эти показатели заимствованы из статистической физики и нейробиологии для описания стохастических процессов.

* **Коэффициент взрывности ($B$):** Определяется как $B \= \\frac{\\sigma \- \\mu}{\\sigma \+ \\mu}$, где $\\sigma$ — стандартное отклонение интервалов, а $\\mu$ — среднее значение. Метрика варьируется от \-1 (строго регулярный, периодический процесс) до 1 (высокая кластеризация событий).  
  * *Гипотеза:* Боты, работающие по расписанию (cron jobs), будут иметь $B \\approx \-1$. Живые люди, проверяющие баланс хаотично, будут иметь $B \\approx 0$. Атаки методом Credential Stuffing проявятся как $B \\approx 1$ (серия быстрых попыток и тишина).  
  * *Наблюдение:* В данных 1 присутствуют значения $B \\approx \-0.1$, что указывает на регулярность, близкую к случайной (процесс Пуассона), но есть и экстремальные значения.  
* **Фактор Фано ($F$):** Определяется как $F \= \\frac{\\sigma^2}{\\mu}$. Это мера дисперсии распределения событий. Высокий фактор Фано указывает на то, что активность пользователя крайне нестабильна ("то густо, то пусто"), что может свидетельствовать о захвате аккаунта (ATO), когда «спящий» счет внезапно активизируется для транзита средств.  
* **Z-Score ($Z$):** Поле zscore\_avg\_login\_interval\_7d измеряет отклонение текущего поведения от исторической нормы. Значения $|Z| \> 3$ являются статистически значимыми аномалиями. В данных 1 встречаются значения, близкие к 0, что говорит о стабильности, но для мошеннических транзакций ожидается резкий скачок этого показателя.

### **1.2. Транзакционная криминалистика: Анализ потоков капитала**

Набор данных транзакции\_в\_Мобильном\_интернет\_Банкинге.csv 1 содержит целевую переменную target (1 \- фрод, 0 \- легитимная операция). Анализ распределения целевого класса критически важен.

#### **1.2.1. Типология мошеннических сумм**

Анализ размеченных транзакций (где target=1) в 1 раскрывает гетерогенную природу атак:

1. **Крупные хищения:** Транзакция на сумму **592,200.0** (клиент 452718092, 2025-08-02) и **300,000.0** (клиент 2937649420, 2025-06-12). Это классический вывод средств (Account Draining), требующий немедленной блокировки.  
2. **Средние переводы:** Суммы порядка **100,000.0** (клиент 453076643, 2025-07-12) и **256,070.0** (клиент 454086659, 2025-08-08).  
3. **Микро-фрод и тестирование карт:** Транзакция на сумму **7,432.3725** (клиент 453148036, 2025-06-23).1 Дробная часть и некруглая сумма могут указывать на автоматическую конвертацию валют или скрипт, пытающийся вывести остаток "под ноль" (Salami slicing attack).

Эта вариативность сумм означает, что модель не может полагаться только на абсолютное значение amount. Необходим переход к относительным величинам (отношение суммы к среднему чеку, к балансу, к лимитам).

#### **1.2.2. Вектор направления и графовые структуры**

Поле direction (хэш получателя) является ключевым для построения графа транзакций. Мошенничество редко бывает изолированным событием; оно существует в рамках сетей отмывания денег (Mule Networks). Если множество уникальных cst\_dim\_id (клиентов) отправляют средства на один и тот же direction в короткий промежуток времени — это классический паттерн «веерного сбора» (Fan-in), характерный для дропов.

---

## **Глава 2\. Архитектура команды AI-агентов и промпт-инжиниринг**

Согласно запросу, для решения задачи необходимо спроектировать и развернуть команду специализированных AI-агентов. Данный подход, известный как *Multi-Agent LLM Framework*, позволяет декомпозировать сложную задачу на атомарные подзадачи, минимизируя галлюцинации и повышая качество кода.

Ниже представлена организационная структура виртуальной команды, их роли, инструменты и детальные системные промпты.

### **2.1. Роль 1: Data Steward & Forensic Analyst (Агент первичного анализа)**

Цель: Обеспечение целостности данных, очистка от шума и выявление фундаментальных аномалий на уровне схемы данных.  
Инструменты: Python (Pandas, Numpy, YData Profiling, Missingno).  
Входные данные:.1  
**Системный Промпт (System Prompt):**

«Вы — Главный Архитектор Данных (Senior Data Steward) в финтех-секторе. Ваша задача — подготовить безупречный фундамент для модели обнаружения фрода.

1. **Интеграция:** Разработайте стратегию слияния (Merge Strategy) поведенческих данных 1 и транзакций.1 Учтите, что поведение — это снимок (snapshot), а транзакция — событие. Используйте pd.merge\_asof по времени transdatetime с отставанием (backward looking), чтобы избежать утечки данных из будущего (Look-ahead bias). Модель в момент транзакции знает только *прошлое* поведение клиента.  
2. **Анализ типов:** Обратите внимание на поле amount в.1 Пример: 7432.3725. Наличие 4 знаков после запятой требует приведения к float64.  
3. **Обработка пропусков:** В поведенческих данных (например, zscore) пропуски часто не случайны (MNAR), а означают "новый клиент" или "отсутствие истории". Создайте отдельные флаги is\_new\_user вместо заполнения средним.  
4. **Временная шкала:** Преобразуйте строковые даты в datetime. Выделите циклические признаки: час дня, день недели. Учтите, что фрод часто происходит в ночное время или в выходные (анализ is\_holiday).  
5. **Очистка:** Идентифицируйте невозможные значения (например, отрицательные интервалы времени) и изолируйте их.»

### **2.2. Роль 2: Feature Engineering Grandmaster (Агент создания признаков)**

Цель: Генерация высокоуровневых признаков, раскрывающих скрытые паттерны мошенничества.  
Инструменты: Featuretools, NetworkX (для графов), Scikit-learn.  
**Системный Промпт (System Prompt):**

«Вы — Грандмастер Kaggle, специализирующийся на табличных данных и фроде. Ваша цель — создать признаки, максимизирующие Information Value (IV).

1. **Velocity Features (Скоростные характеристики):** Рассчитайте скользящие окна (1 час, 24 часа, 7 дней) для каждого cst\_dim\_id. Сгенерируйте: count\_txn\_1h, sum\_amount\_24h, std\_amount\_7d. Отношение текущей суммы к среднему за 30 дней — мощнейший сигнал.  
2. **Interaction Features (Взаимодействия):** Скомбинируйте данные из 1 и.1 Пример: Transaction\_Amount / Avg\_Login\_Interval. Высокая сумма при низкой частоте входов — подозрительно.  
3. **Identity Consistency (Целостность личности):** Используйте monthly\_os\_changes.1 Если изменений \> 1, создайте флаг high\_risk\_device. Закодируйте (Target Encoding) пары last\_phone\_model \+ last\_os\_categorical. Редкие комбинации (например, старый Android на новом железе) часто свидетельствуют об эмуляции.  
4. **Graph Features (Графовые признаки):** Для каждого direction (получателя) в 1 вычислите: количество уникальных отправителей (degree\_centrality), среднюю сумму входящих переводов, дисперсию времени между входящими переводами (Burst Receive).  
5. **Time-Delta:** Вычислите время, прошедшее с последней транзакции этого пользователя (time\_since\_last\_txn). Экстремально малые значения (\< 2 сек) указывают на скриптовую атаку.»

### **2.3. Роль 3: Model Architect & AutoML Expert (Агент моделирования)**

Цель: Обучение, настройка и ансамблирование моделей.  
Инструменты: CatBoost, XGBoost, LightGBM, Optuna, Imbalanced-learn.  
**Системный Промпт (System Prompt):**

«Вы — Ведущий ML-инженер. Ваша задача — построить устойчивый классификатор.

1. **Стратегия валидации:** СТРОГО используйте TimeSeriesSplit. Обучайтесь на прошлых датах, тестируйте на будущих. Перемешивание (Shuffle) запрещено из\-за временной зависимости фрода.  
2. **Выбор алгоритмов:** Используйте Градиентный Бустинг (GBDT).  
   * **CatBoost:** Идеален для категориальных признаков из 1 (last\_phone\_model). Не используйте One-Hot Encoding для признаков с высокой кардинальностью, доверьтесь встроенным механизмам CatBoost.  
   * **LightGBM:** Для скорости и обработки больших объемов данных.  
3. **Работа с дисбалансом:** Используйте scale\_pos\_weight или class\_weights, чтобы увеличить штраф за пропуск фрода (False Negative). Метрика оптимизации — **ROC-AUC** или **PR-AUC**, но не Accuracy.  
4. **Ансамблирование:** Реализуйте стекинг (Stacking). Обучите мета-модель (Логистическую регрессию) на предсказаниях базовых моделей.»

### **2.4. Роль 4: The Skeptic & Auditor (Агент аудита и интерпретации)**

Цель: Проверка модели на переобучение, предвзятость и интерпретируемость (согласно методологии ForteBank 1).  
Инструменты: SHAP (SHapley Additive exPlanations), Lime, Confusion Matrix.  
**Системный Промпт (System Prompt):**

«Вы — Риск-аудитор. Ваша задача — "сломать" модель и найти в ней уязвимости.

1. **Интерпретируемость:** Используйте SHAP Values для объяснения каждого решения. Если модель опирается только на amount, она неустойчива. Убедитесь, что поведенческие факторы (например, burstiness из 1) вносят вклад. Это требование раздела "Usability" методологии.1  
2. **Adversarial Validation:** Обучите классификатор отличать Train от Test. Если AUC \> 0.7, данные имеют сильный временной дрейф. Найдите дрейфующие признаки и удалите их.  
3. **Бизнес-метрики:** Рассчитайте, сколько денег спасет модель при фиксированном уровне ложных срабатываний (например, False Positive Rate \< 1%). Это "язык денег", понятный бизнесу.»

---

## **Глава 3\. Глубокий анализ данных и инсайты второго порядка**

Успех решения зависит от способности извлечь скрытые взаимосвязи, которые не очевидны при поверхностном просмотре.

### **3.1. Феномен «Временных дыр» и зомби-сессии**

В файле 1 присутствует метрика ewm\_login\_interval\_7d (экспоненциально взвешенное среднее интервалов). Сравнение этого показателя с avg\_login\_interval\_30d позволяет выявить паттерн **«Внезапное пробуждение»**.

* *Инсайт:* Если пользователь имел средний интервал входа 10 дней (редкий гость), а за последние 7 дней интервал сократился до 5 минут (EWMA резко упал), это признак того, что аккаунт попал в руки злоумышленника, который проверяет баланс или лимиты перед выводом.  
* *Применение:* Агент должен создать признак wakeup\_ratio \= ewm\_login\_interval\_7d / avg\_login\_interval\_30d. Значения близкие к 0 — зона высочайшего риска.

### **3.2. Аномалии в версионировании ПО**

Поле last\_os\_categorical в 1 содержит строки вида Android/13, iOS/17.6.1. Однако встречаются и подозрительные значения, такие как Android/5.10.0 (строка 16 в 1).

* *Инсайт:* Версии Android обычно целочисленные (10, 11, 12\) или с минорными обновлениями. Строка "5.10.0" может быть артефактом кастомной прошивки или некорректно настроенного User-Agent в эмуляторе скрипта. Также присутствуют значения iOS/18.5 и iOS/26.0 (строки 3 и 15 в 1). На момент анализа (судя по датам 2025 года) iOS 18.5 возможна как бета, но iOS/26.0 — это явная аномалия и фейк (несуществующая версия).  
* *Применение:* Создание признака is\_fake\_os\_version. Любая версия iOS выше текущей актуальной (на дату транзакции) должна маркироваться как 100% фрод. Это «жесткое правило» (Hard Rule), которое может работать быстрее ML-модели.

### **3.3. Анализ «Дроп-сетей» через графы**

В файле 1 поле direction содержит хэши получателей.

* *Паттерн:* В данных есть получатели, принимающие средства от десятков разных клиентов. Легитимные сценарии такого поведения — оплата ЖКХ или магазины. Но если транзакции происходят в ночное время, имеют круглые суммы и исходят от устройств с высоким burstiness 1, то direction — это кошелек дропа.  
* *Инсайт:* Графовые признаки (Graph Embeddings), такие как PageRank или HITS, рассчитанные на графе транзакций, позволят выявить узловые точки (hubs) в сети отмывания денег. Даже если новый клиент чист, перевод на «грязный» узел скомпрометирует его.

### **3.4. Временная корреляция атак**

Данные 1 показывают транзакции с метками времени. Анализ дат (например, 2025-06-12, 2025-08-02) позволяет выявить сезонность атак.

* *Инсайт:* Мошеннические кампании часто запускаются волнами (Fraud Waves). Если модель видит всплеск фрода с определенным паттерном (например, сумма 10000 \+ Android 13\) в течение часа, она должна динамически повышать скоринг риска для всех похожих транзакций в реальном времени. Это требует реализации признаков "Time since last fraud in system".

---

## **Глава 4\. Техническая реализация и стекинг моделей**

Для победы в хакатоне недостаточно одной модели. Необходим каскад (Pipeline) решений.

### **4.1. Препроцессинг и очистка (Data Cleaning Pipeline)**

AI-агенты должны реализовать следующий конвейер:

1. **Parsing:** Приведение transdatetime к формату UTC.  
2. **Categorical Clustering:** Поля last\_phone\_model\_categorical содержат тысячи уникальных значений (Xiaomi, Samsung, iPhone разных версий). Агент должен сгруппировать их:  
   * Все iPhone16,x \-\> High-End iOS  
   * Все Samsung SM-A... \-\> Mid-Range Android  
   * Редкие модели \-\> Rare\_Device  
     Это снижает размерность и помогает модели обобщать (уменьшает переобучение на конкретных ID устройств).

### **4.2. Генерация признаков (Feature Engineering)**

Таблица ниже описывает приоритетные признаки, которые должны создать агенты.

**Таблица 2\. Карта приоритетных признаков (Feature Importance Map)**

| Группа признаков | Название | Описание и Формула | Источник | Влияние (Impact) |
| :---- | :---- | :---- | :---- | :---- |
| **Biometrics** | Burstiness | Регулярность входов. Отклонение от хаоса. | 1 | Высокое (Bot detection) |
| **Biometrics** | Device\_Hopping | monthly\_os\_changes / days\_active | 1 | Критическое (Farm detection) |
| **Transactional** | Velocity\_24h | Сумма транзакций за последние 24ч / Среднее за 30 дней | 1 | Высокое (ATO detection) |
| **Graph** | Fan\_In\_Count | Число уникальных плательщиков на одного получателя | 1 | Высокое (Mule detection) |
| **Interaction** | Time\_Since\_OS\_Change | Разница во времени между транзакцией и сменой ОС | 1\+1 | Критическое (New device fraud) |
| **Anomaly** | Fake\_OS\_Flag | Флаг: версия ОС \> текущей реальной (напр. iOS 26\) | 1 | Абсолютное (Hard Rule) |

### **4.3. Стратегия моделирования (Modeling Strategy)**

Рекомендуется использовать двухуровневую архитектуру (Stacking):

* **Уровень 1 (Base Learners):**  
  1. **CatBoost:** Обучается на всех данных, используя нативную поддержку категориальных признаков (os\_ver, phone\_model). Функция потерь: Logloss или Focal Loss (для работы с дисбалансом).  
  2. **LightGBM:** Обучается на числовых агрегатах и статистиках. Быстрый, хорошо находит границы решений.  
  3. **Autoencoder (Neural Network):** Обучается *только* на легитимных транзакциях (Target=0). Его задача — сжимать и восстанавливать данные. Ошибка восстановления (Reconstruction Error) для фродовых транзакций будет высокой, так как они отличаются от нормы. Эта ошибка используется как дополнительный признак.  
* **Уровень 2 (Meta-Learner):**  
  * **Logistic Regression:** Принимает на вход вероятности от моделей 1-го уровня и выдает финальный скор. Это позволяет линейно взвесить вклад каждой модели и избежать переобучения ансамбля.

### **4.4. Валидация и Борьба с переобучением**

Стандартная Cross-Validation (K-Fold) неприменима из\-за временной структуры. Агенты должны настроить **Walk-Forward Validation**:

* Fold 1: Train (Jan-Feb), Test (Mar)  
* Fold 2: Train (Jan-Mar), Test (Apr)  
* ...  
* Fold N: Train (Jan-Jul), Test (Aug)

Такой подход моделирует реальную работу системы в продакшене, где мы не знаем будущего.

---

## **Глава 5\. Соответствие методологии ForteBank и Инновационность**

Согласно документу «Методология AI Hackathon ForteBank» 1, решение оценивается не только по метрикам (Accuracy/AUC), но и по **Юзабилити (Usability)** и **Интерпретируемости**.

### **5.1. Объяснимый ИИ (Explainable AI \- XAI)**

Черный ящик неприемлем в банке. Решение должно предоставлять объяснение для каждой блокировки.

* **Механизм:** Использование библиотеки SHAP. Для каждой подозрительной транзакции агенты генерируют "Force Plot", показывающий, какие именно признаки сдвинули скор в красную зону (например: "Скор повышен, так как: 1\. Смена устройства 1 час назад, 2\. Сумма транзакции в 10 раз выше средней").  
* **Ценность:** Это позволяет операторам антифрод-центра (людям) быстрее принимать решения по "серым" транзакциям, повышая доверие к системе.

### **5.2. Бизнес-импакт и поддержка философии банка**

Внедрение предложенной системы поддерживает философию банка «Помогаем. Поддерживаем. Создаём» 1, защищая средства клиентов (особенно уязвимых групп) от кражи. Агенты должны настроить пороги срабатывания (thresholds) так, чтобы минимизировать блокировку легитимных клиентов (False Positives), так как ложные блокировки снижают лояльность и NPS (Net Promoter Score).

---

## **Заключение**

Предлагаемое решение для задачи №1 AI-хакатона ForteBank представляет собой сложную экосистему, управляемую командой AI-агентов. Вместо простого "скармливания" данных модели, стратегия подразумевает глубокую реконструкцию контекста: от физики поведения пользователя до топологии графа транзакций.

Ключевые факторы победы:

1. **Детекция эмуляторов:** Использование признаков monthly\_os\_changes и аномальных версий ОС (iOS 26.0) для выявления ферм.1  
2. **Биометрия поведения:** Применение метрик burstiness и fano\_factor для отделения людей от ботов.1  
3. **Графовый анализ:** Выявление дропов через анализ direction в.1  
4. **Валидация:** Строгий Time-Series Split для гарантии устойчивости к будущим атакам.

Реализация данной дорожной карты с использованием современных инструментов (CatBoost, SHAP, NetworkX) и мультиагентного подхода обеспечит создание решения уровня State-of-the-Art, полностью соответствующего высоким стандартам ForteBank.

#### **Works cited**

1. поведенческие\_паттерны\_клиентов\_3.csv