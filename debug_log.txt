2025-11-22 12:40:42,847 - INFO - Loading data...
2025-11-22 12:40:42,886 - INFO - Loaded behavior data: (8587, 19)
2025-11-22 12:40:42,886 - INFO - Loaded transactions data: (13113, 7)
2025-11-22 12:40:42,886 - INFO - Cleaning data...
2025-11-22 12:40:42,898 - INFO - Merging data...
2025-11-22 12:40:42,898 - INFO - Transactions dtypes: transdatetime=datetime64[ns], cst_dim_id=int64
2025-11-22 12:40:42,898 - INFO - Behavior dtypes: transdate=datetime64[ns], cst_dim_id=int64
2025-11-22 12:40:42,908 - INFO - Merged data shape: (13107, 28)
2025-11-22 12:40:42,911 - INFO - Generating features...
2025-11-22 12:40:42,911 - INFO - Generating velocity features...
2025-11-22 12:40:42,948 - INFO - Generating interaction features...
2025-11-22 12:40:42,948 - INFO - Generating identity features...
2025-11-22 12:40:42,955 - INFO - Generating graph features...
2025-11-22 12:40:42,962 - INFO - Generating time delta features...
2025-11-22 12:40:42,984 - INFO - Cat feature last_os_categorical unique values: ['Android/14' 'Android/15' 'Android/11' 'iOS/17.5.1' 'iOS/18.3.1'
 'iOS/18.3.2' 'Android/13' 'mibWebv3/13.2.2' 'iOS/18.1.1' 'iOS/18.4.1']
2025-11-22 12:40:42,985 - INFO - Cat feature last_os_categorical has NaNs: 0
2025-11-22 12:40:42,985 - INFO - Cat feature last_os_categorical dtype: object
2025-11-22 12:40:42,985 - INFO - Value at index 68 for last_os_categorical: Android/14
2025-11-22 12:40:42,985 - INFO - Type at index 68 for last_os_categorical: <class 'str'>
2025-11-22 12:40:42,985 - INFO - Cat feature last_phone_model_categorical unique values: ['Xiaomi 2306EPN60G' 'Xiaomi M2006C3LG' 'Samsung SM-A135F'
 'Xiaomi 2312DRA50G' 'OPPO CPH2481' 'iPhone14,7' 'Samsung SM-A105F'
 'Xiaomi 23106RN0DA' 'Oppo_cph2481' 'Xiaomi 22071212AG']
2025-11-22 12:40:42,986 - INFO - Cat feature last_phone_model_categorical has NaNs: 0
2025-11-22 12:40:42,986 - INFO - Cat feature last_phone_model_categorical dtype: object
2025-11-22 12:40:42,986 - INFO - Value at index 68 for last_phone_model_categorical: Xiaomi 2312DRA50G
2025-11-22 12:40:42,986 - INFO - Type at index 68 for last_phone_model_categorical: <class 'str'>
2025-11-22 12:40:42,986 - INFO - Training final model on all data...
2025-11-22 12:40:48,464 - INFO - Final model trained.
2025-11-22 12:40:48,466 - INFO - Generating SHAP explanation...
0:	total: 61.7ms	remaining: 1m 1s
100:	total: 597ms	remaining: 5.31s
200:	total: 1.14s	remaining: 4.52s
300:	total: 1.68s	remaining: 3.91s
400:	total: 2.21s	remaining: 3.3s
500:	total: 2.71s	remaining: 2.7s
600:	total: 3.23s	remaining: 2.15s
700:	total: 3.75s	remaining: 1.6s
800:	total: 4.28s	remaining: 1.06s
900:	total: 4.86s	remaining: 533ms
999:	total: 5.45s	remaining: 0us
Traceback (most recent call last):
  File "_catboost.pyx", line 2600, in _catboost.get_cat_factor_bytes_representation
  File "_catboost.pyx", line 2115, in _catboost.get_id_object_bytes_string_representation
_catboost.CatBoostError: bad object for id: nan

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/apolorotov/Desktop/Agents/ForteContest/src/agents/auditor.py", line 88, in <module>
    auditor.explain_shap()
  File "/Users/apolorotov/Desktop/Agents/ForteContest/src/agents/auditor.py", line 25, in explain_shap
    shap_values = explainer.shap_values(sample_df)
  File "/Users/apolorotov/Library/Python/3.9/lib/python/site-packages/shap/explainers/_tree.py", line 605, in shap_values
    X = catboost.Pool(X, cat_features=self.model.cat_feature_indices)
  File "/Users/apolorotov/Library/Python/3.9/lib/python/site-packages/catboost/core.py", line 855, in __init__
    self._init(data, label, cat_features, text_features, embedding_features, embedding_features_data, pairs, graph, weight,
  File "/Users/apolorotov/Library/Python/3.9/lib/python/site-packages/catboost/core.py", line 1491, in _init
    self._init_pool(data, label, cat_features, text_features, embedding_features, embedding_features_data, pairs, graph, weight,
  File "_catboost.pyx", line 4329, in _catboost._PoolBase._init_pool
  File "_catboost.pyx", line 4381, in _catboost._PoolBase._init_pool
  File "_catboost.pyx", line 4190, in _catboost._PoolBase._init_features_order_layout_pool
  File "_catboost.pyx", line 3087, in _catboost._set_features_order_data_pd_data_frame
  File "_catboost.pyx", line 2607, in _catboost.get_cat_factor_bytes_representation
_catboost.CatBoostError: Invalid type for cat_feature[non-default value idx=68,feature_idx=19]=nan : cat_features must be integer or string, real number values and NaN values should be converted to string.

