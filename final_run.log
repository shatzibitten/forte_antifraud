2025-11-24 10:58:36,429 - INFO - Starting ForteBank AI Hackathon Pipeline...
2025-11-24 10:58:36,430 - INFO - Loading data...
2025-11-24 10:58:36,471 - INFO - Loaded behavior data: (8587, 19)
2025-11-24 10:58:36,471 - INFO - Loaded transactions data: (13113, 7)
2025-11-24 10:58:36,471 - INFO - Cleaning data...
2025-11-24 10:58:36,486 - INFO - Merging data...
2025-11-24 10:58:36,486 - INFO - Transactions dtypes: transdatetime=datetime64[ns], cst_dim_id=int64
2025-11-24 10:58:36,486 - INFO - Behavior dtypes: transdate=datetime64[ns], cst_dim_id=int64
2025-11-24 10:58:36,492 - INFO - Merged data shape: (13107, 28)
2025-11-24 10:58:36,494 - INFO - Generating features...
2025-11-24 10:58:36,494 - INFO - Generating velocity features...
2025-11-24 10:58:36,526 - INFO - Generating interaction features...
2025-11-24 10:58:36,528 - INFO - Generating identity features...
2025-11-24 10:58:36,533 - INFO - Generating external features (MCC, OS)...
2025-11-24 10:58:36,567 - INFO - Generating velocity features...
2025-11-24 10:58:36,598 - INFO - Generating IEEE-CIS features...
2025-11-24 10:58:36,601 - INFO - Generating graph features...
2025-11-24 10:58:36,607 - INFO - Generating time delta features...
2025-11-24 10:58:36,609 - INFO - Generating GNN embeddings...
2025-11-24 10:58:36,611 - INFO - Building transaction graph for embeddings...
2025-11-24 10:58:36,613 - INFO - Graph has 2291 nodes (clients + receivers).
2025-11-24 10:58:36,617 - INFO - Generating graph embeddings via TruncatedSVD...
2025-11-24 10:58:36,633 - INFO - Embeddings generated. Explained variance: 0.3792
2025-11-24 10:58:36,645 - INFO - Generating anomaly features (Isolation Forest)...
2025-11-24 10:58:36,793 - INFO - 
============================================================
2025-11-24 10:58:36,793 - INFO - DATA SPLIT:
2025-11-24 10:58:36,794 - INFO - Train set: 11141 transactions (2024-11-30 05:45:05 to 2025-07-07 15:19:13)
2025-11-24 10:58:36,794 - INFO - Holdout set: 1966 transactions (2025-07-07 15:24:01 to 2025-08-29 22:12:01)
2025-11-24 10:58:36,794 - INFO - Train fraud rate: 0.0056
2025-11-24 10:58:36,794 - INFO - Holdout fraud rate: 0.0524
2025-11-24 10:58:36,794 - INFO - ============================================================

2025-11-24 10:58:36,804 - INFO - 
============================================================
2025-11-24 10:58:36,804 - INFO - TRAINING MODELS (Optuna: False)
2025-11-24 10:58:36,804 - INFO - ============================================================

2025-11-24 10:58:36,804 - INFO - Training final CatBoost model...
2025-11-24 10:58:42,780 - INFO - Final CatBoost model trained.
2025-11-24 10:58:42,781 - INFO - Training LightGBM model...
2025-11-24 10:58:45,483 - INFO - LightGBM model trained.
2025-11-24 10:58:45,484 - INFO - Training XGBoost model...
2025-11-24 10:58:46,507 - INFO - XGBoost model trained.
2025-11-24 10:58:46,507 - INFO - Training Stacking Ensemble (3 base models)...
2025-11-24 10:58:46,508 - INFO - Generating out-of-fold predictions...
2025-11-24 10:58:54,037 - INFO - Stacking Meta-Model Coefficients: [[1.7515143  0.09018062 2.9154603 ]]
2025-11-24 10:58:54,037 - INFO - Training Probability Calibrator (Isotonic Regression)...
2025-11-24 10:58:54,041 - INFO - Saving models to models/...
2025-11-24 10:58:54,066 - INFO - Models saved successfully.
2025-11-24 10:58:54,066 - INFO - Generating SHAP explanations...
2025-11-24 10:58:54,069 - INFO - Generating SHAP explanation...
2025-11-24 10:58:54,876 - INFO - SHAP summary saved to shap_summary.png
2025-11-24 10:58:54,878 - INFO - Using Fraud Threshold from config: 0.5
2025-11-24 10:58:54,878 - INFO - 
============================================================
2025-11-24 10:58:54,878 - INFO - TRAIN SET METRICS (reference only):
2025-11-24 10:58:54,878 - INFO - ============================================================
2025-11-24 10:58:54,881 - INFO - Calculating business metrics...
2025-11-24 10:58:54,997 - INFO - Saved Money: 21,048,997.37
2025-11-24 10:58:54,997 - INFO - Lost Money: 0.00
2025-11-24 10:58:54,997 - INFO - Blocked Legit Money: 0.00
2025-11-24 10:58:54,997 - INFO - 
============================================================
2025-11-24 10:58:54,997 - INFO - HOLDOUT TEST SET METRICS (final evaluation):
2025-11-24 10:58:54,997 - INFO - ============================================================
2025-11-24 10:58:55,000 - INFO - Analyzing data drift...
2025-11-24 10:58:55,005 - INFO - 
============================================================
2025-11-24 10:58:55,005 - INFO - TOP 10 DRIFTING FEATURES:
2025-11-24 10:58:55,005 - INFO - ============================================================
2025-11-24 10:58:55,005 - INFO - monthly_os_changes: score=0.3655 (Train: 1.38 -> Holdout: 1.12)
2025-11-24 10:58:55,005 - INFO - monthly_phone_model_changes: score=0.3162 (Train: 1.32 -> Holdout: 1.13)
2025-11-24 10:58:55,005 - INFO - logins_last_30_days: score=0.2866 (Train: 45.52 -> Holdout: 33.37)
2025-11-24 10:58:55,005 - INFO - high_risk_device: score=0.2736 (Train: 0.31 -> Holdout: 0.18)
2025-11-24 10:58:55,005 - INFO - is_fake_os: score=0.2185 (Train: 0.00 -> Holdout: 0.01)
2025-11-24 10:58:55,005 - INFO - zscore_avg_login_interval_7d: score=0.2082 (Train: -0.19 -> Holdout: -0.30)
2025-11-24 10:58:55,005 - INFO - fano_factor_login_interval: score=0.1789 (Train: 226425.73 -> Holdout: 275210.03)
2025-11-24 10:58:55,005 - INFO - logins_last_7_days: score=0.1656 (Train: 12.08 -> Holdout: 9.95)
2025-11-24 10:58:55,005 - INFO - direction_txn_count: score=0.1529 (Train: 59.25 -> Holdout: 50.03)
2025-11-24 10:58:55,005 - INFO - time_since_last_txn: score=0.1516 (Train: 408746.53 -> Holdout: 532849.48)
2025-11-24 10:58:55,005 - INFO - ============================================================

2025-11-24 10:58:55,005 - INFO - 
============================================================
2025-11-24 10:58:55,005 - INFO - LLM EXPLAINER AGENT (Top 3 Suspicious Cases in Holdout)
2025-11-24 10:58:55,005 - INFO - ============================================================
2025-11-24 10:58:55,006 - INFO - Generating explanations for top 3 fraud cases...
2025-11-24 10:58:55,141 - INFO - 
### Case #1 (Transaction ID: 12363)
**Risk Score:** 0.9466
**Key Risk Factors:**
- **direction_txn_count**: 1.00
- **amount_to_avg_30d**: 111.84
- **Transaction Amount**: 500000.00


### Case #2 (Transaction ID: 11757)
**Risk Score:** 0.8974
**Key Risk Factors:**
- **direction_txn_count**: 1.00
- **amount_to_avg_30d**: 23.12
- **Transaction Amount**: 500000.00


### Case #3 (Transaction ID: 12691)
**Risk Score:** 0.8956
**Key Risk Factors:**
- **direction_txn_count**: 1.00
- **amount_to_avg_30d**: 20.73
- **last_phone_model_categorical_freq**: 0.00

2025-11-24 10:58:55,141 - INFO - ============================================================

2025-11-24 10:58:55,141 - INFO - Calculating business metrics...
2025-11-24 10:58:55,166 - INFO - Saved Money: 8,048,437.00
2025-11-24 10:58:55,167 - INFO - Lost Money: 7,969,720.00
2025-11-24 10:58:55,167 - INFO - Blocked Legit Money: 6,369,951.00
2025-11-24 10:58:55,167 - INFO - 
============================================================
2025-11-24 10:58:55,167 - INFO - SUMMARY:
2025-11-24 10:58:55,167 - INFO - ============================================================
2025-11-24 10:58:55,167 - INFO - Train Set Saved: 21,048,997.37 KZT
2025-11-24 10:58:55,167 - INFO - Holdout Set Saved: 8,048,437.00 KZT
2025-11-24 10:58:55,167 - INFO - Holdout Set Lost: 7,969,720.00 KZT
2025-11-24 10:58:55,167 - INFO - ============================================================

0:	total: 67.4ms	remaining: 1m 7s
100:	total: 657ms	remaining: 5.85s
200:	total: 1.22s	remaining: 4.87s
300:	total: 1.85s	remaining: 4.29s
400:	total: 2.5s	remaining: 3.73s
500:	total: 3.05s	remaining: 3.03s
600:	total: 3.59s	remaining: 2.38s
700:	total: 4.16s	remaining: 1.77s
800:	total: 4.75s	remaining: 1.18s
900:	total: 5.33s	remaining: 586ms
999:	total: 5.92s	remaining: 0us
